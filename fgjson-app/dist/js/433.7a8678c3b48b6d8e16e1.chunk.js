(self.webpackChunkfgjson_app=self.webpackChunkfgjson_app||[]).push([[433],{22433:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>Ko});var r=o(37101),s=o(45697),i=o.n(s),n=o(57557),a=o.n(n),l=o(2479);const p=e=>(0,l.jM)((t=>a()(t,e))),h={locale:navigator&&navigator.language,formats:{},messages:{},defaultLocale:"en",defaultFormats:{},formatDate:e=>e,formatTime:e=>e,formatRelative:e=>e,formatNumber:e=>e,formatPlural:e=>e,formatMessage:e=>e,formatHTMLMessage:e=>e,now:()=>new Date};var c=o(37566),u=o(73800),d=o(86306),m=o(70878),g=o(78471),y=o(76773),f=o(18672),v=o(99937),_=o(40868),w=o(21915),b=o(94401),C=o(84110),x=o(44183),E=o(67294),S=o.n(E),L=o(27418),P=o.n(L),T=o(10312),F=o(54980),O=o(68105);var I=o(45801),G=o(18369),M=o(78516),k=o(52),j=o(48041),Z=o(78653),D=o(97950),R=o(52043),N=o(44538),A=o(52329),V=o(25642),z=o(13987),B=o(28795),H=o(32538),U=o(38667),W=function(e){function t(t,o,r){if(e.call(this),void 0!==r&&void 0===o)this.setFlatCoordinates(r,t);else{var s=o||0;this.setCenterAndRadius(t,s,r)}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.clone=function(){return new t(this.flatCoordinates.slice(),void 0,this.layout)},t.prototype.closestPointXY=function(e,t,o,r){var s=this.flatCoordinates,i=e-s[0],n=t-s[1],a=i*i+n*n;if(a<r){if(0===a)for(var l=0;l<this.stride;++l)o[l]=s[l];else{var p=this.getRadius()/Math.sqrt(a);o[0]=s[0]+p*i,o[1]=s[1]+p*n;for(var h=2;h<this.stride;++h)o[h]=s[h]}return o.length=this.stride,a}return r},t.prototype.containsXY=function(e,t){var o=this.flatCoordinates,r=e-o[0],s=t-o[1];return r*r+s*s<=this.getRadiusSquared_()},t.prototype.getCenter=function(){return this.flatCoordinates.slice(0,this.stride)},t.prototype.computeExtent=function(e){var t=this.flatCoordinates,o=t[this.stride]-t[0];return(0,w.T9)(t[0]-o,t[1]-o,t[0]+o,t[1]+o,e)},t.prototype.getRadius=function(){return Math.sqrt(this.getRadiusSquared_())},t.prototype.getRadiusSquared_=function(){var e=this.flatCoordinates[this.stride]-this.flatCoordinates[0],t=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return e*e+t*t},t.prototype.getType=function(){return B.Z.CIRCLE},t.prototype.intersectsExtent=function(e){var t=this.getExtent();if((0,w.kK)(e,t)){var o=this.getCenter();return e[0]<=o[0]&&e[2]>=o[0]||e[1]<=o[1]&&e[3]>=o[1]||(0,w.H6)(e,this.intersectsCoordinate,this)}return!1},t.prototype.setCenter=function(e){var t=this.stride,o=this.flatCoordinates[t]-this.flatCoordinates[0],r=e.slice();r[t]=r[0]+o;for(var s=1;s<t;++s)r[t+s]=e[s];this.setFlatCoordinates(this.layout,r),this.changed()},t.prototype.setCenterAndRadius=function(e,t,o){this.setLayout(o,e,0),this.flatCoordinates||(this.flatCoordinates=[]);var r=this.flatCoordinates,s=(0,U.IG)(r,0,e,this.stride);r[s++]=r[0]+t;for(var i=1,n=this.stride;i<n;++i)r[s++]=r[i];r.length=s,this.changed()},t.prototype.getCoordinates=function(){return null},t.prototype.setCoordinates=function(e,t){},t.prototype.setRadius=function(e){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+e,this.changed()},t}(H.ZP);W.prototype.transform;const q=W;var K=o(40353);const X=function(){let e,{type:t,coordinates:o,radius:r,center:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};switch(t){case"Point":e=new R.Z(o||[]);break;case"LineString":e=new N.Z(o||[]);break;case"MultiPoint":e=new A.Z(o||[]);break;case"MultiLineString":e=new V.Z(o||[]);break;case"MultiPolygon":e=new z.Z(o||[]);break;default:e=r&&s?(0,K.Bb)(new q([s.x,s.y],r),100):new K.ZP(o||[])}return e},Y={dragPan:{options:{kinetic:!1},Instance:u.Z},keyboardPan:{options:{kinetic:!1},Instance:I.Z},mouseWheelZoom:{options:{duration:0},Instance:d.Z},doubleClickZoom:{options:{duration:0},Instance:G.Z},shiftDragZoom:{options:{duration:0},Instance:M.Z},keyboardZoom:{options:{},Instance:k.Z},pinchZoom:{options:{duration:0},Instance:j.Z},pinchRotate:{options:{},Instance:Z.Z},altShiftDragRotate:{options:{},Instance:D.Z}};var $=o(18446),J=o.n($),Q=o(13311),ee=o.n(Q),te=o(23493),oe=o.n(te),re=o(1469),se=o.n(re),ie=o(14293),ne=o.n(ie),ae=o(93379),le=o.n(ae),pe=o(91133);le()(pe.Z,{insert:"head",singleton:!1}),pe.Z.locals;var he=o(14976);function ce(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}le()(he.Z,{insert:"head",singleton:!1}),he.Z.locals;class ue extends S().Component{constructor(){var e;super(...arguments),e=this,ce(this,"getDocument",(()=>this.props.document||document)),ce(this,"getResolutions",(()=>{if(this.props.mapOptions&&this.props.mapOptions.view&&this.props.mapOptions.view.resolutions)return this.props.mapOptions.view.resolutions;let e=void 0!==this.props.mapOptions.minZoom?this.props.mapOptions.minZoom:0,t=void 0!==this.props.mapOptions.maxZoom?this.props.mapOptions.maxZoom:28,o=void 0!==this.props.mapOptions.zoomFactor?this.props.mapOptions.zoomFactor:2;const r=this.map.getView().getProjection(),s=r.getExtent();let i,n,a=(s?(0,w.dz)(s):360*_.default.METERS_PER_UNIT[_.default.DEGREES]/_.default.METERS_PER_UNIT[r.getUnits()])/256,l=(s?(0,w.Cr)(s):360*_.default.METERS_PER_UNIT[_.default.DEGREES]/_.default.METERS_PER_UNIT[r.getUnits()])/256;a<=l?(i=1,n=Math.round(l/a),l/=n):(n=1,i=Math.round(a/l),a/=i);const p=Math.max(a,l),h=p/Math.pow(2,28);let c=this.props.mapOptions.maxResolution;void 0!==c?e=0:c=p/Math.pow(o,e);let u=this.props.mapOptions.minResolution;return void 0===u&&(u=void 0!==this.props.mapOptions.maxZoom?void 0!==this.props.mapOptions.maxResolution?c/Math.pow(o,t):p/Math.pow(o,t):h),t=e+Math.floor(Math.log(c/u)/Math.log(o)),Array.apply(0,Array(t-e+1)).map(((e,t)=>c/Math.pow(o,t)))})),ce(this,"mouseMoveEvent",(e=>{if(!e.dragging&&e.coordinate){const t=this.map.get("elevationLayer")&&this.map.get("elevationLayer").get("getElevation");let o=e.coordinate.slice(),r=(0,f.bU)(o,this.props.projection),s=r[0]/360%1*360;s<-180?s+=360:s>180&&(s-=360),this.props.onMouseMove({y:r[1]||0,x:s||0,z:this.map.get("elevationLayer")&&this.map.get("elevationLayer").get("getElevation")(o,e.pixel)||void 0,crs:"EPSG:4326",pixel:{x:e.pixel[0],y:e.pixel[1]},latlng:{lat:r[1],lng:s,z:t&&t(o,e.pixel)||void 0},lat:r[1],lng:s,rawPos:e.coordinate.slice()})}})),ce(this,"updateMapInfoState",(()=>{let e=this.map.getView(),t=e.getCenter(),o=e.getProjection().getExtent();const r=e.getProjection().getCode();if(-1!==["EPSG:3857","EPSG:900913","EPSG:4326"].indexOf(r)||t&&t[0]>=o[0]&&t[0]<=o[2]&&t[1]>=o[1]&&t[1]<=o[3]){let t=this.normalizeCenter(e.getCenter()),o=e.calculateExtent(this.map.getSize()),s={width:this.map.getSize()[0],height:this.map.getSize()[1]};this.props.onMapViewChanges({x:t[0]||0,y:t[1]||0,crs:"EPSG:4326"},e.getZoom(),{bounds:{minx:o[0],miny:o[1],maxx:o[2],maxy:o[3]},crs:r,rotation:e.getRotation()},s,this.props.id,this.props.projection,void 0,e.getResolution())}})),ce(this,"haveResolutionsChanged",(e=>{const t=this.props.mapOptions&&this.props.mapOptions.view?this.props.mapOptions.view.resolutions:void 0,o=e.mapOptions&&e.mapOptions.view?e.mapOptions.view.resolutions:void 0;return!J()(t,o)})),ce(this,"createView",(function(e,t,o,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const i=s.restrictedExtent&&s.crs&&(0,T.reprojectBbox)(s.restrictedExtent,s.crs,(0,T.normalizeSRS)(o)),n=!r||r&&!r.view?P()({},r,{extent:i}):P()({},r),a=P()({},{projection:(0,T.normalizeSRS)(o),center:[e.x,e.y],zoom:t,minZoom:s.minZoom},n||{});return new y.ZP(a)})),ce(this,"_updateMapPositionFromNewProps",(e=>{var t=this.map.getView();const o=this.props.center;if(e.center.y!==o.y||e.center.x!==o.x){let o=(0,T.reproject)({x:e.center.x,y:e.center.y},"EPSG:4326",e.projection,!0);t.setCenter([o.x,o.y])}Math.round(e.zoom)!==this.props.zoom&&t.setZoom(Math.round(e.zoom)),(e.bbox&&void 0!==e.bbox.rotation||this.bbox&&void 0!==this.bbox.rotation&&e.bbox.rotation!==this.props.bbox.rotation)&&t.setRotation(e.bbox.rotation)})),ce(this,"normalizeCenter",(e=>{let t=(0,T.reproject)({x:e[0],y:e[1]},this.props.projection,"EPSG:4326",!0);return[t.x,t.y]})),ce(this,"setMousePointer",(e=>{this.map&&(this.map.getViewport().style.cursor=e||"auto")})),ce(this,"registerHooks",(()=>{this.props.hookRegister.registerHook(O.default.RESOLUTIONS_HOOK,(()=>this.getResolutions())),this.props.hookRegister.registerHook(O.default.RESOLUTION_HOOK,(()=>this.map.getView().getResolution())),this.props.hookRegister.registerHook(O.default.COMPUTE_BBOX_HOOK,((e,t)=>{var o=(0,T.reproject)([e.x,e.y],"EPSG:4326",this.props.projection);let r=this.createView(o,t,this.props.projection,this.props.mapOptions&&this.props.mapOptions.view,this.props.limits),s=this.map.getSize(),i=r.calculateExtent(s);return{bounds:{minx:i[0],miny:i[1],maxx:i[2],maxy:i[3]},crs:this.props.projection,rotation:this.map.getView().getRotation()}})),this.props.hookRegister.registerHook(O.default.GET_PIXEL_FROM_COORDINATES_HOOK,(e=>this.map.getPixelFromCoordinate(e))),this.props.hookRegister.registerHook(O.default.GET_COORDINATES_FROM_PIXEL_HOOK,(e=>this.map.getCoordinateFromPixel(e))),this.props.hookRegister.registerHook(O.default.ZOOM_TO_EXTENT_HOOK,(function(t){let{padding:o,crs:r,maxZoom:s,duration:i,nearest:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=(0,T.reprojectBbox)(t,r,e.props.projection);a&&a[0]===a[2]&&a[1]===a[3]&&"EPSG:4326"===r&&se()(t)&&-180===t[0]&&-90===t[1]&&(a=e.map.getView().getProjection().getExtent());let l=s;a&&a[0]===a[2]&&a[1]===a[3]&&ne()(l)&&(l=21),e.map.getView().fit(a,{size:e.map.getSize(),padding:o&&[o.top||0,o.right||0,o.bottom||0,o.left||0],maxZoom:l,duration:i,nearest:n})}))}))}componentDidMount(){this.props.projectionDefs.forEach((e=>{const t=b.default.defs(e.code);var o,r,s,i,n;o=e.code,r=e.extent,s=e.worldExtent,i=e.axisOrientation||t.axis||"enu",n=t.units||"m",(0,f.Sx)(new x.Z({code:o,extent:r,worldExtent:s,axisOrientation:i,units:n}))}));let e=(0,T.reproject)([this.props.center.x,this.props.center.y],"EPSG:4326",this.props.projection);!function(e){var t,o,r=Object.keys(e.defs),s=r.length;for(t=0;t<s;++t){var i=r[t];if(!(0,f.U2)(i)){var n=e.defs(i);(0,f.Sx)(new x.Z({code:i,axisOrientation:n.axis,metersPerUnit:n.to_meter,units:n.units}))}}for(t=0;t<s;++t){var a=r[t],l=(0,f.U2)(a);for(o=0;o<s;++o){var p=r[o],h=(0,f.U2)(p);if(!(0,C.U2)(a,p))if(e.defs[a]===e.defs[p])(0,f.rM)([l,h]);else{var c=e(a,p);(0,f.zY)(l,h,c.forward,c.inverse)}}}}(b.default);let t=P()(this.props.interactive?{}:{doubleClickZoom:!1,dragPan:!1,altShiftDragRotate:!1,keyboard:!1,mouseWheelZoom:!1,shiftDragZoom:!1,pinchRotate:!1,pinchZoom:!1},this.props.mapOptions.interactions),o=(0,c.ce)(P()({dragPan:!1,mouseWheelZoom:!1},t,{}));void 0!==t&&void 0!==t.dragPan||(this.dragPanInteraction=new u.Z({kinetic:!1}),o.extend([this.dragPanInteraction])),void 0!==t&&void 0!==t.mouseWheelZoom||(this.mouseWheelInteraction=new d.Z({duration:0}),o.extend([this.mouseWheelInteraction]));let r=(0,m.c)(P()({zoom:this.props.zoomControl,attributionOptions:P()({collapsible:!1},this.props.mapOptions.attribution&&this.props.mapOptions.attribution.container?{target:this.getDocument().querySelector(this.props.mapOptions.attribution.container)}:{})},this.props.mapOptions.controls)),s=new g.default({layers:[],controls:r,interactions:o,maxTilesLoading:1/0,target:this.getDocument().getElementById(this.props.id)||"".concat(this.props.id),view:this.createView(e,Math.round(this.props.zoom),this.props.projection,this.props.mapOptions&&this.props.mapOptions.view,this.props.limits)});this.map=s,this.props.registerHooks&&this.registerHooks(),this.map.disabledListeners={},this.map.disableEventListener=e=>{this.map.disabledListeners[e]=!0},this.map.enableEventListener=e=>{delete this.map.disabledListeners[e]},this.map.getViewport().addEventListener("mouseout",(()=>{setTimeout((()=>this.props.onMouseOut()),150)})),s.on("moveend",this.updateMapInfoState),s.on("singleclick",(e=>{if(this.props.onClick&&!this.map.disabledListeners.singleclick){let t=this.map.getView(),o=e.coordinate.slice(),r=t.getProjection().getExtent();if("EPSG:4326"===this.props.projection&&(o[0]=(0,T.normalizeLng)(o[0])),"EPSG:900913"!==this.props.projection&&"EPSG:3857"!==this.props.projection||(o=(0,f.bU)(o,this.props.projection),r=(0,T.reprojectBbox)(r,this.props.projection,"EPSG:4326")),o[0]>=r[0]&&o[0]<=r[2]&&o[1]>=r[1]&&o[1]<=r[3]){let t,r;t="EPSG:900913"!==this.props.projection&&"EPSG:3857"!==this.props.projection?(0,T.reproject)(o,this.props.projection,"EPSG:4326"):{x:o[0],y:o[1]},this.markerPresent=!1,s.forEachFeatureAtPixel(e.pixel,((e,o)=>{if(o&&o.get("handleClickOnLayer")){const s=e.getGeometry();if(!this.markerPresent&&"Point"===s.getType()){this.markerPresent=!0,r=o.get("msId");const e=(0,f.bU)(s.getFirstCoordinate(),this.props.projection);t={x:e[0],y:e[1]}}}}));const i=(0,T.normalizeLng)(t.x),n=this.map.get("elevationLayer")&&this.map.get("elevationLayer").get("getElevation");this.props.onClick({pixel:{x:e.pixel[0],y:e.pixel[1]},latlng:{lat:t.y,lng:i,z:n&&n(o,e.pixel)||void 0},rawPos:e.coordinate.slice(),modifiers:{alt:e.originalEvent.altKey,ctrl:e.originalEvent.ctrlKey,metaKey:e.originalEvent.metaKey,shift:e.originalEvent.shiftKey}},r)}}}));const i=oe()(this.mouseMoveEvent,100);s.on("pointermove",i),this.updateMapInfoState(),this.setMousePointer(this.props.mousePointer),this.forceUpdate(),this.props.onResolutionsChange(this.getResolutions())}UNSAFE_componentWillReceiveProps(e){if(e.mousePointer!==this.props.mousePointer&&this.setMousePointer(e.mousePointer),e.zoomControl!==this.props.zoomControl&&(e.zoomControl?this.map.addControl(new v.Z):this.map.removeControl(this.map.getControls().getArray().filter((e=>e instanceof v.Z))[0])),this.map&&(this.props.mapOptions&&this.props.mapOptions.interactions)!==(e.mapOptions&&e.mapOptions.interactions)){const t=e.mapOptions.interactions||{},o=this.map.getInteractions().getArray();Object.keys(t).forEach((e=>{const{Instance:r,options:s}=Y[e]||{};let i=ee()(o,(t=>Y[e]&&t instanceof r));i?i.setActive(t[e]):t[e]&&r&&this.map.addInteraction(new r(s))}))}if(this.map&&this.props.id!==e.mapStateSource&&this._updateMapPositionFromNewProps(e),this.map&&e.resize!==this.props.resize&&setTimeout((()=>{this.map.updateSize()}),0),this.map&&(this.props.projection!==e.projection||this.haveResolutionsChanged(e))||this.props.limits!==e.limits){if(this.props.projection!==e.projection||this.props.limits!==e.limits){let t=e.projection;const o=(0,T.reproject)([e.center.x,e.center.y],"EPSG:4326",t);this.map.setView(this.createView(o,e.zoom,e.projection,e.mapOptions&&e.mapOptions.view,e.limits)),this.props.onResolutionsChange(this.getResolutions())}this.map.getLayers().forEach((e=>{let t=e.getSource();t.getTileLoadFunction&&t.setTileLoadFunction(t.getTileLoadFunction())})),this.map.render()}}componentWillUnmount(){const e=this.props.mapOptions.attribution&&this.props.mapOptions.attribution.container&&this.getDocument().querySelector(this.props.mapOptions.attribution.container);if(e&&e.querySelector(".ol-attribution"))try{e.removeChild(e.querySelector(".ol-attribution"))}catch(e){}this.map&&this.map.setTarget(null)}render(){const e=this.map,t=e?S().Children.map(this.props.children,(t=>t?S().cloneElement(t,{map:e,mapId:this.props.id,onLayerLoading:this.props.onLayerLoading,onLayerError:this.props.onLayerError,onLayerLoad:this.props.onLayerLoad,projection:this.props.projection,onCreationError:this.props.onCreationError,resolutions:this.getResolutions()}):null)):null;return S().createElement("div",{id:this.props.id,style:this.props.style},t)}}ce(ue,"propTypes",{id:i().string,document:i().object,style:i().object,center:F.ZP.PropTypes.center,zoom:i().number.isRequired,mapStateSource:F.ZP.PropTypes.mapStateSource,projection:i().string,projectionDefs:i().array,onMapViewChanges:i().func,onResolutionsChange:i().func,onClick:i().func,mapOptions:i().object,zoomControl:i().bool,mousePointer:i().string,onMouseMove:i().func,onLayerLoading:i().func,onLayerLoad:i().func,onLayerError:i().func,resize:i().number,measurement:i().object,changeMeasurementState:i().func,registerHooks:i().bool,hookRegister:i().object,interactive:i().bool,onCreationError:i().func,bbox:i().object,wpsBounds:i().object,onWarning:i().func,maxExtent:i().array,limits:i().object,onMouseOut:i().func}),ce(ue,"defaultProps",{id:"map",onMapViewChanges:()=>{},onResolutionsChange:()=>{},onCreationError:()=>{},onClick:null,onMouseMove:()=>{},mapOptions:{},projection:"EPSG:3857",projectionDefs:[],onLayerLoading:()=>{},onLayerLoad:()=>{},onLayerError:()=>{},resize:0,registerHooks:!0,hookRegister:O.default,interactive:!0,onMouseOut:()=>{},center:{x:13,y:45,crs:"EPSG:4326"},zoom:5});const de=ue;var me=o(40392),ge=o(89255),ye=o(81763),fe=o.n(ye);function ve(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class _e extends S().Component{constructor(){super(...arguments),ve(this,"setLayerVisibility",(e=>{const t=this.props.options&&!1!==this.props.options.visibility,o=e.options&&!1!==e.options.visibility;o!==t&&this.layer&&this.isValid()&&this.layer.setVisible(o)})),ve(this,"setLayerOpacity",(e=>{e!==(this.props.options&&void 0!==this.props.options.opacity?this.props.options.opacity:1)&&this.layer&&this.layer.setOpacity(e)})),ve(this,"generateOpts",((e,t,o,r,s,i)=>{const{minResolution:n,maxResolution:a,disableResolutionLimits:l,...p}=e,h={...p,...!l&&{minResolution:n,maxResolution:a,minZoom:ne()(a)?void 0:(0,O.getZoomFromResolution)(a,i),maxZoom:ne()(n)?void 0:(0,O.getZoomFromResolution)(n,i)}};return P()({},h,fe()(t)?{zIndex:t}:null,{srs:o,onError:()=>{this.props.onCreationError(h)},securityToken:r,env:s})})),ve(this,"createLayer",((e,t,o,r,s,i)=>{if(e){const n=this.generateOpts(t,o,(0,T.normalizeSRS)(this.props.srs),r,s,i);this.layer=me.default.createLayer(e,n,this.props.map,this.props.mapId);const a=me.default.isCompatible(e,n);if(this.layer&&!this.layer.detached){const e=this.props.map,o=e&&e.getView().getProjection().getExtent(),r=t&&t.bbox&&t.bbox.bounds,s=o&&(0,T.reprojectBbox)(o,this.props.srs,"EPSG:4326");let i=r&&(0,T.reprojectBbox)((0,T.getExtentFromNormalized)(r,this.props.srs).extent,"EPSG:4326");i&&2===i.length&&se()(i[1])&&(i=i[1]),(s&&i&&!(0,T.isBboxCompatible)((0,T.getPolygonFromExtent)(s),(0,T.getPolygonFromExtent)(i))||!a)&&this.props.onWarning({title:"warning",message:"notification.incompatibleDataAndProjection",action:{label:"close"},position:"tc",uid:"1"}),this.addLayer(t)}this.layer&&this.layer.get&&this.layer.get("getElevation")&&this.props.map.set("elevationLayer",this.layer),this.forceUpdate()}})),ve(this,"updateLayer",((e,t)=>{if(e.position===t.position&&e.srs===t.srs&&e.securityToken===t.securityToken){if(e.options===t.options)return;if(J()(a()(e.options,["loading"]),a()(t.options,["loading"])))return}const o=me.default.updateLayer(this.props.type,this.layer,this.generateOpts(e.options,e.position,e.projection,e.securityToken,e.env,e.resolutions),this.generateOpts(t.options,t.position,t.projection,t.securityToken,t.env,t.resolutions),this.props.map,this.props.mapId);o&&(this.props.map.removeLayer(this.layer),this.layer=o,this.addLayer(e.options))})),ve(this,"addLayer",(e=>{if(this.isValid()){this.props.map.addLayer(this.layer);const t=new ge.xQ,o=new ge.xQ;e.handleClickOnLayer&&this.layer.set("handleClickOnLayer",!0),this.layer.getSource().on("tileloadstart",(()=>{0===this.tilestoload?(this.props.onLayerLoading(e.id),this.tilestoload++):this.tilestoload++})),this.layer.getSource().on("tileloadend",(()=>{t.next({type:"tileloadend"}),this.tilestoload--,0===this.tilestoload&&o.next()})),this.layer.getSource().on("tileloaderror",(e=>{t.next({type:"tileloaderror",event:e}),this.tilestoload--,0===this.tilestoload&&o.next()})),t.bufferWhen((()=>o)).subscribe({next:t=>{const o=t.filter((e=>"tileloaderror"===e.type));o.length>0&&(e&&!e.hideErrors||!e)?(this.props.onLayerLoad(e.id,{error:!0}),this.props.onLayerError(e.id,t.length,o.length)):this.props.onLayerLoad(e.id)}}),this.tileLoadEndStream$=t,this.tileStopStream$=o;const r=new ge.xQ,s=new ge.xQ;if(this.layer.getSource().on("imageloadstart",(()=>{0===this.imagestoload?(this.props.onLayerLoading(e.id),this.imagestoload++):this.imagestoload++})),this.layer.getSource().on("imageloadend",(()=>{this.imagestoload--,r.next({type:"imageloadend"}),0===this.imagestoload&&s.next()})),this.layer.getSource().on("imageloaderror",(e=>{this.imagestoload--,r.next({type:"imageloaderror",event:e}),0===this.imagestoload&&s.next()})),r.bufferWhen((()=>s)).subscribe({next:t=>{const o=t.filter((e=>"imageloaderror"===e.type));o.length>0?(this.props.onLayerLoad(e.id,{error:!0}),(e&&!e.hideErrors||!e)&&this.props.onLayerError(e.id,t.length,o.length)):this.props.onLayerLoad(e.id)}}),this.imageLoadEndStream$=r,this.imageStopStream$=s,this.layer.getSource().on("vectorerror",(()=>{this.props.onLayerLoad(e.id,{error:!0})})),e.refresh){let t=0;this.refreshTimer=setInterval((()=>{this.layer.getSource().updateParams(P()({},e.params,{_refreshCounter:t++}))}),e.refresh)}}})),ve(this,"isValid",(()=>{const e=me.default.isValid(this.props.type,this.layer);return this.valid=e,e}))}componentDidMount(){this.valid=!0,this.tilestoload=0,this.imagestoload=0,this.createLayer(this.props.type,this.props.options,this.props.position,this.props.securityToken,this.props.env,this.props.resolutions)}UNSAFE_componentWillReceiveProps(e){this.setLayerVisibility(e);const t=e.options&&void 0!==e.options.opacity?e.options.opacity:1;this.setLayerOpacity(t),e.position!==this.props.position&&this.layer&&this.layer.setZIndex&&this.layer.setZIndex(e.position),this.props.options&&this.updateLayer(e,this.props)}componentWillUnmount(){this.layer&&this.props.map&&(this.tileLoadEndStream$&&(this.tileLoadEndStream$.complete(),this.tileStopStream$.complete(),this.imageLoadEndStream$.complete(),this.imageStopStream$.complete()),this.layer.detached?this.layer.remove():this.props.map.removeLayer(this.layer)),this.refreshTimer&&clearInterval(this.refreshTimer),me.default.removeLayer(this.props.type,this.props.options,this.props.map,this.props.mapId,this.layer)}render(){if(this.props.children){const e=this.layer,t=e?S().Children.map(this.props.children,(t=>t?S().cloneElement(t,{container:e,styleName:this.props.options&&this.props.options.styleName}):null)):null;return S().createElement(S().Fragment,null,t)}return me.default.renderLayer(this.props.type,this.props.options,this.props.map,this.props.mapId,this.layer)}}ve(_e,"propTypes",{onWarning:i().func,maxExtent:i().array,map:i().object,mapId:i().string,srs:i().string,type:i().string,options:i().object,onLayerLoading:i().func,onLayerError:i().func,onCreationError:i().func,onLayerLoad:i().func,position:i().number,observables:i().array,securityToken:i().string,env:i().array,resolutions:i().array}),ve(_e,"defaultProps",{observables:[],onLayerLoading:()=>{},onLayerLoad:()=>{},onLayerError:()=>{},onCreationError:()=>{},onWarning:()=>{},srs:"EPSG:3857"});var we=o(9669),be=o.n(we),Ce=o(52353),xe=o.n(Ce),Ee=o(84596),Se=o.n(Ee),Le=o(80034);const Pe=(e,t,o,r)=>{if(se()(t)&&se()(t[0])&&se()(t[0][0])){const s=(0,T.reproject)(t[0][0],r,o);return Math.sqrt(Math.pow(e[0]-s.x,2)+Math.pow(e[1]-s.y,2))}return 100},Te=function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;if(!e.getGeometry()||"Polygon"!==e.getGeometry().getType()||e.getProperties().center&&0===e.getProperties().center.length)return e;if(e.getProperties()&&e.getProperties().isCircle&&e.getProperties().center&&e.getProperties().center[0]&&e.getProperties().center[1]){const r=e.getGeometry().getExtent();let s;e.getProperties().center?(s=(0,T.reproject)(e.getProperties().center,"EPSG:4326",t),s=[s.x,s.y]):s=(0,w.qg)(r);const i=e.getProperties().crs===t?e.getProperties().radius:Pe(s,e.getGeometry().getCoordinates(),t,o);return e.setGeometry(new q(s,i)),e}return e};var Fe=o(79055),Oe=o(69141);function Ie(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class Ge extends S().Component{constructor(){super(...arguments),Ie(this,"addFeatures",(e=>{const t=new Oe.Z;let o=null,r=!1;"FeatureCollection"===e.type?(o={features:xe()(e.properties.visibility)||e.properties.visibility?e.features:[]},r=!!e.features):(o={geometry:e.geometry},r=!(!e.geometry||!e.geometry.geometries&&!e.geometry.coordinates)),e.container&&r&&(this._feature=t.readFeatures({type:e.type,properties:e.properties,id:e.msId,...o},{dataProjection:e.featuresCrs}),this._feature.map((t=>{let o=t;return t.getProperties().isCircle&&(o=Te(t,e.crs||"EPSG:3857",e.featuresCrs),o.setGeometry(o.getGeometry().transform(e.crs||"EPSG:3857",e.featuresCrs))),o})).forEach((t=>t.getGeometry().transform(e.featuresCrs,e.crs||"EPSG:3857"))),e.style&&e.style!==e.layerStyle&&this._feature.forEach((t=>{let o=[],r={};"FeatureCollection"===e.type?(r=ee()(e.features,(e=>e.properties.id===t.getProperties().id)),o=(0,Fe.createStylesAsync)(Se()(r.style))):(o=(0,Fe.createStylesAsync)(Se()(e.style)),r={type:e.type,geometry:e.geometry,properties:e.properties,style:e.style}),be().all(o).then((e=>{t.setStyle((()=>(0,Le.Cw)({...r,style:e})))}))})),e.container.getSource().addFeatures(this._feature))})),Ie(this,"removeFromContainer",(()=>{if(this._feature)if(Array.isArray(this._feature)){const e=this.props.container.getSource();this._feature.map((t=>{let o=t.getId();void 0!==o&&e.getFeatureById(o)?e.removeFeature(e.getFeatureById(o)):e.removeFeature(t)}))}else this.props.container.getSource().removeFeature(this._feature)}))}componentDidMount(){this.addFeatures(this.props)}shouldComponentUpdate(e){return!(J()(e.properties,this.props.properties)&&J()(e.geometry,this.props.geometry)&&J()(e.features,this.props.features)&&J()(e.crs,this.props.crs)&&J()(e.style,this.props.style))}UNSAFE_componentWillUpdate(e){this.removeFromContainer(),this.addFeatures(e)}componentWillUnmount(){this.removeFromContainer()}render(){return null}}Ie(Ge,"propTypes",{type:i().string,layerStyle:i().object,style:i().object,properties:i().object,crs:i().string,container:i().object,features:i().array,geometry:i().object,msId:i().oneOfType([i().string,i().number]),featuresCrs:i().string}),Ie(Ge,"defaultProps",{featuresCrs:"EPSG:4326"});var Me=o(59854),ke=o.n(Me),je=o(27361),Ze=o.n(je),De=o(43624),Re=o.n(De),Ne=o(10928),Ae=o.n(Ne),Ve=o(39859),ze=o(94310),Be=o(99677),He=o(93409),Ue=o(97016),We=o(29902),qe=o(23068),Ke=o(31219),Xe=o(98185),Ye=o(20767),$e=o(9371),Je=o(73381),Qe=o(30006),et=o(86968),tt=o(58493),ot=o(90728),rt=o(13002),st=o(9520),it=o(36403),nt=o(64011),at=o(14303),lt=o(38024),pt=o(73604),ht="Point",ct="LineString",ut="Polygon",dt="Circle",mt="drawstart",gt=function(e){function t(t,o){e.call(this,t),this.feature=o}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(st.ZP),yt=function(e){function t(t){var o=t;o.stopDown||(o.stopDown=nt.Dv),e.call(this,o),this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.freehand_=!1,this.source_=t.source?t.source:null,this.features_=t.features?t.features:null,this.snapTolerance_=t.snapTolerance?t.snapTolerance:12,this.type_=t.type,this.mode_=function(e){var t;return e===B.Z.POINT||e===B.Z.MULTI_POINT?t=ht:e===B.Z.LINE_STRING||e===B.Z.MULTI_LINE_STRING?t=ct:e===B.Z.POLYGON||e===B.Z.MULTI_POLYGON?t=ut:e===B.Z.CIRCLE&&(t=dt),t}(this.type_),this.stopClick_=!!t.stopClick,this.minPoints_=t.minPoints?t.minPoints:this.mode_===ut?3:2,this.maxPoints_=t.maxPoints?t.maxPoints:1/0,this.finishCondition_=t.finishCondition?t.finishCondition:nt.uX;var r,s=t.geometryFunction;if(!s)if(this.type_===B.Z.CIRCLE)s=function(e,t){var o=t||new q([NaN,NaN]),r=(0,ot.bI)(e[0],e[1]);return o.setCenterAndRadius(e[0],Math.sqrt(r)),o};else{var i,n=this.mode_;n===ht?i=R.Z:n===ct?i=N.Z:n===ut&&(i=K.ZP),s=function(e,t){var o=t;return o?n===ut?e[0].length?o.setCoordinates([e[0].concat([e[0][0]])]):o.setCoordinates([]):o.setCoordinates(e):o=new i(e),o}}this.geometryFunction_=s,this.dragVertexDelay_=void 0!==t.dragVertexDelay?t.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=t.clickTolerance?t.clickTolerance*t.clickTolerance:36,this.overlay_=new We.Z({source:new Ue.Z({useSpatialIndex:!1,wrapX:!!t.wrapX&&t.wrapX}),style:t.style?t.style:(r=(0,Ke.createEditingStyle)(),function(e,t){return r[e.getGeometry().getType()]}),updateWhileInteracting:!0}),this.geometryName_=t.geometryName,this.condition_=t.condition?t.condition:it.rM,this.freehandCondition_,t.freehand?this.freehandCondition_=it.Bx:this.freehandCondition_=t.freehandCondition?t.freehandCondition:it.vY,(0,rt.oL)(this,(0,tt.v_)(pt.Z.ACTIVE),this.updateState_,this)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.setMap=function(t){e.prototype.setMap.call(this,t),this.updateState_()},t.prototype.getOverlay=function(){return this.overlay_},t.prototype.handleEvent=function(t){t.originalEvent.type===Je.Z.CONTEXTMENU&&t.preventDefault(),this.freehand_=this.mode_!==ht&&this.freehandCondition_(t);var o=t.type===Qe.Z.POINTERMOVE,r=!0;return!this.freehand_&&this.lastDragTime_&&t.type===Qe.Z.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=t.pixel,this.shouldHandle_=!this.freehand_,o=!0):this.lastDragTime_=void 0,this.shouldHandle_&&void 0!==this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&t.type===Qe.Z.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(t),r=!1):this.freehand_&&t.type===Qe.Z.POINTERDOWN?r=!1:o?(r=t.type===Qe.Z.POINTERMOVE)&&this.freehand_?r=this.handlePointerMove_(t):(t.pointerEvent.pointerType==at.T2||t.type===Qe.Z.POINTERDRAG&&void 0===this.downTimeout_)&&this.handlePointerMove_(t):t.type===Qe.Z.DBLCLICK&&(r=!1),e.prototype.handleEvent.call(this,t)&&r},t.prototype.handleDownEvent=function(e){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=e.pixel,this.finishCoordinate_||this.startDrawing_(e),!0):!!this.condition_(e)&&(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(function(){this.handlePointerMove_(new et.Z(Qe.Z.POINTERMOVE,e.map,e.pointerEvent,!1,e.frameState))}.bind(this),this.dragVertexDelay_),this.downPx_=e.pixel,!0)},t.prototype.handleUpEvent=function(e){var t=!0;this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(e);var o=this.mode_===dt;return this.shouldHandle_?(this.finishCoordinate_?this.freehand_||o?this.finishDrawing():this.atFinish_(e)?this.finishCondition_(e)&&this.finishDrawing():this.addToDrawing_(e):(this.startDrawing_(e),this.mode_===ht&&this.finishDrawing()),t=!1):this.freehand_&&(this.finishCoordinate_=null,this.abortDrawing_()),!t&&this.stopClick_&&e.stopPropagation(),t},t.prototype.handlePointerMove_=function(e){if(this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){var t=this.downPx_,o=e.pixel,r=t[0]-o[0],s=t[1]-o[1],i=r*r+s*s;if(this.shouldHandle_=this.freehand_?i>this.squaredClickTolerance_:i<=this.squaredClickTolerance_,!this.shouldHandle_)return!0}return this.finishCoordinate_?this.modifyDrawing_(e):this.createOrUpdateSketchPoint_(e),!0},t.prototype.atFinish_=function(e){var t=!1;if(this.sketchFeature_){var o=!1,r=[this.finishCoordinate_];if(this.mode_===ct)o=this.sketchCoords_.length>this.minPoints_;else if(this.mode_===ut){var s=this.sketchCoords_;o=s[0].length>this.minPoints_,r=[s[0][0],s[0][s[0].length-2]]}if(o)for(var i=e.map,n=0,a=r.length;n<a;n++){var l=r[n],p=i.getPixelFromCoordinate(l),h=e.pixel,c=h[0]-p[0],u=h[1]-p[1],d=this.freehand_?1:this.snapTolerance_;if(t=Math.sqrt(c*c+u*u)<=d){this.finishCoordinate_=l;break}}}return t},t.prototype.createOrUpdateSketchPoint_=function(e){var t=e.coordinate.slice();this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(t):(this.sketchPoint_=new qe.Z(new R.Z(t)),this.updateSketchFeatures_())},t.prototype.startDrawing_=function(e){var t=e.coordinate;this.finishCoordinate_=t,this.mode_===ht?this.sketchCoords_=t.slice():this.mode_===ut?(this.sketchCoords_=[[t.slice(),t.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[t.slice(),t.slice()],this.sketchLineCoords_&&(this.sketchLine_=new qe.Z(new N.Z(this.sketchLineCoords_)));var o=this.geometryFunction_(this.sketchCoords_);this.sketchFeature_=new qe.Z,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(o),this.updateSketchFeatures_(),this.dispatchEvent(new gt(mt,this.sketchFeature_))},t.prototype.modifyDrawing_=function(e){var t,o,r,s=e.coordinate,i=this.sketchFeature_.getGeometry();if(this.mode_===ht?o=this.sketchCoords_:this.mode_===ut?(o=(t=this.sketchCoords_[0])[t.length-1],this.atFinish_(e)&&(s=this.finishCoordinate_.slice())):o=(t=this.sketchCoords_)[t.length-1],o[0]=s[0],o[1]=s[1],this.geometryFunction_(this.sketchCoords_,i),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(s),i.getType()==B.Z.POLYGON&&this.mode_!==ut){this.sketchLine_||(this.sketchLine_=new qe.Z);var n=i.getLinearRing(0);(r=this.sketchLine_.getGeometry())?(r.setFlatCoordinates(n.getLayout(),n.getFlatCoordinates()),r.changed()):(r=new N.Z(n.getFlatCoordinates(),n.getLayout()),this.sketchLine_.setGeometry(r))}else this.sketchLineCoords_&&(r=this.sketchLine_.getGeometry()).setCoordinates(this.sketchLineCoords_);this.updateSketchFeatures_()},t.prototype.addToDrawing_=function(e){var t,o,r=e.coordinate,s=this.sketchFeature_.getGeometry();this.mode_===ct?(this.finishCoordinate_=r.slice(),(o=this.sketchCoords_).length>=this.maxPoints_&&(this.freehand_?o.pop():t=!0),o.push(r.slice()),this.geometryFunction_(o,s)):this.mode_===ut&&((o=this.sketchCoords_[0]).length>=this.maxPoints_&&(this.freehand_?o.pop():t=!0),o.push(r.slice()),t&&(this.finishCoordinate_=o[0]),this.geometryFunction_(this.sketchCoords_,s)),this.updateSketchFeatures_(),t&&this.finishDrawing()},t.prototype.removeLastPoint=function(){if(this.sketchFeature_){var e,t=this.sketchFeature_.getGeometry();this.mode_===ct?((e=this.sketchCoords_).splice(-2,1),this.geometryFunction_(e,t),e.length>=2&&(this.finishCoordinate_=e[e.length-2].slice())):this.mode_===ut&&((e=this.sketchCoords_[0]).splice(-2,1),this.sketchLine_.getGeometry().setCoordinates(e),this.geometryFunction_(this.sketchCoords_,t)),0===e.length&&(this.finishCoordinate_=null),this.updateSketchFeatures_()}},t.prototype.finishDrawing=function(){var e=this.abortDrawing_();if(e){var t=this.sketchCoords_,o=e.getGeometry();this.mode_===ct?(t.pop(),this.geometryFunction_(t,o)):this.mode_===ut&&(t[0].pop(),this.geometryFunction_(t,o),t=o.getCoordinates()),this.type_===B.Z.MULTI_POINT?e.setGeometry(new A.Z([t])):this.type_===B.Z.MULTI_LINE_STRING?e.setGeometry(new V.Z([t])):this.type_===B.Z.MULTI_POLYGON&&e.setGeometry(new z.Z([t])),this.dispatchEvent(new gt("drawend",e)),this.features_&&this.features_.push(e),this.source_&&this.source_.addFeature(e)}},t.prototype.abortDrawing_=function(){this.finishCoordinate_=null;var e=this.sketchFeature_;return e&&(this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0)),e},t.prototype.extend=function(e){var t=e.getGeometry();this.sketchFeature_=e,this.sketchCoords_=t.getCoordinates();var o=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=o.slice(),this.sketchCoords_.push(o.slice()),this.updateSketchFeatures_(),this.dispatchEvent(new gt(mt,this.sketchFeature_))},t.prototype.updateSketchFeatures_=function(){var e=[];this.sketchFeature_&&e.push(this.sketchFeature_),this.sketchLine_&&e.push(this.sketchLine_),this.sketchPoint_&&e.push(this.sketchPoint_);var t=this.overlay_.getSource();t.clear(!0),t.addFeatures(e)},t.prototype.updateState_=function(){var e=this.getMap(),t=this.getActive();e&&t||this.abortDrawing_(),this.overlay_.setMap(t?e:null)},t}(lt.Z);const ft=yt;var vt=o(56834),_t=o(70295);function wt(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}const bt=e=>e.getView().getProjection().getCode();class Ct extends S().Component{constructor(){var e;super(...arguments),e=this,wt(this,"getLength",((e,t)=>{if("Bearing"===t.measurement.geomType&&e.length>1)return(0,T.calculateAzimuth)(e[0],e[1],bt(t.map));const o=this.reprojectedCoordinatesIn4326(e);return(0,T.calculateDistance)(o,t.measurement.lengthFormula)})),wt(this,"getArea",(e=>this.calculateGeodesicArea(e.getLinearRing(0).getCoordinates()))),wt(this,"updateInteraction",((e,t)=>{t.some((e=>Ze()(e,"properties.disabled")))?this.removeDrawInteraction():null===this.drawInteraction&&(this.restoreDrawState(),this.addDrawInteraction(e))})),wt(this,"convertPolyToLineFeature",(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=[];const r=(0,Ve.wd)(t[0]);return r&&(0,Ve.wd)(t[1])?o=e.reprojectedCoordinatesFrom4326([t[0],t[1]]):r&&(o=e.reprojectedCoordinatesFrom4326([t[0]])),o.length?new N.Z(o):null})),wt(this,"modifyFeatures",(e=>{var t,o,r,s;let{currentFeature:i,features:n}=e.measurement||{},a=(null===(t=n[i])||void 0===t||null===(o=t.geometry)||void 0===o?void 0:o.coordinates)||[],l=(null===(r=n[i])||void 0===r||null===(s=r.geometry)||void 0===s?void 0:s.type)||"";var p;"Polygon"===l&&(a=(null===(p=a)||void 0===p?void 0:p[0])||[]);const h=a.length,c=a.some((e=>!(0,Ve.wd)(e)));let u;if(!c&&"LineString"===l&&h<2){const e=this.reprojectedCoordinatesFrom4326(a);u=new N.Z(e),n[i]=(0,ze.t8)("properties.disabled",!0,(0,ze.t8)("geometry.coordinates",[...a,["",""]],n[i]))}else!c&&"Polygon"===l&&h<=4&&J()(a[h-1],a[h-2])&&(a.splice(2,0,["",""]),a.pop(),n[i]=(0,ze.t8)("properties.disabled",!0,(0,ze.t8)("geometry.coordinates",[a],n[i])));var d,m,g,y;let f;return"Polygon"===l&&h<=4&&(u=this.convertPolyToLineFeature(a)),!c&&J()(a[h-1],a[h-2])&&(null===(d=n[i])||void 0===d||null===(m=d.geometry)||void 0===m||null===(g=m.coordinates)||void 0===g||null===(y=g[0])||void 0===y||y.pop()),u&&(this.source.clear(),f=new qe.Z({geometry:u})),[n,f]})),wt(this,"updateFeatures",(e=>{const[t,o]=this.modifyFeatures(e)||[],r=this.source.getFeatures();this.removeMeasureTooltips(),this.removeSegmentLengthOverlays(),this.source.clear(),this.textLabels=[],this.segmentLengths=[];let s=null;this.updateInteraction(e,t);const i=t.map(((t,i)=>{if(Ze()(t,"properties.disabled"))return s=i,[t,r&&r[i]&&r[i].getGeometry()||(null==o?void 0:o.getGeometry())];const n=t.geometry.type,a=Ze()(t,"properties.values",[]),l="bearing"===(a[0]||{}).type||!(a[0]||{}).type&&e.measurement.bearingMeasureEnabled,p="Polygon"===n?t.geometry.coordinates[0]:t.geometry.coordinates;let h=p;"LineString"===n&&p.length>=2&&!l&&(h=(0,T.transformLineToArcs)(p));const c=this.reprojectedCoordinatesFrom4326(h),u="Polygon"===n?new K.ZP([c]):new N.Z(c),d={Point:()=>p,LineString:()=>l?(0,T.calculateAzimuth)(p[0],p[1],"EPSG:4326"):(0,T.calculateDistance)(p,e.measurement.lengthFormula),Polygon:()=>this.getArea(u)},m={LineString:()=>this.formatLengthValue(l?(0,T.calculateAzimuth)(p[0],p[1],"EPSG:4326"):(0,T.calculateDistance)(p,e.measurement.lengthFormula),e.uom,l,e.measurement.trueBearing),Polygon:()=>this.formatAreaValue(this.getArea(u),e.uom)},g=this.reprojectedCoordinatesFrom4326(p);if(!l)for(let t=0;t<p.length-1;++t){this.createSegmentLengthOverlay();const o=(0,T.calculateAzimuth)(p[t],p[t+1],"EPSG:4326"),r=(0,T.calculateDistance)([p[t],p[t+1]],e.measurement.lengthFormula),s=this.props.measurement&&this.props.measurement.showLengthAndBearingLabel&&" | "+(0,Ve.rp)(o,this.props.measurement.trueBearing)||"",i=this.formatLengthValue(r,e.uom,l)+s;Ae()(this.segmentOverlayElements).innerHTML=i;let a=(0,T.midpoint)(p[t],p[t+1],!0),c=(0,T.midpoint)(g[t],g[t+1],!0);if("LineString"===n){const e=h[100*t+50];e&&(a=e,c=(0,T.pointObjectToArray)((0,T.reproject)(e,"EPSG:4326",bt(this.props.map))))}Ae()(this.segmentOverlays).setPosition(c),this.textLabels[this.segmentOverlays.length-1]={text:i,position:a},this.segmentLengths[this.segmentOverlays.length-1]={value:r,type:l?"bearing":"length"}}if(this.createMeasureTooltip(),"Polygon"===n&&this.createMeasureTooltip(),this.tooltipCoord="LineString"===n?Ae()(g):this.tooltipCoord=u.getInteriorPoint().getCoordinates(),Ae()(this.measureTooltipElements).innerHTML=m[n](),Ae()(this.measureTooltips).setPosition(this.tooltipCoord),this.outputValues[this.measureTooltipElements.length-1]={value:d[n](),type:"Polygon"===n?"area":l?"bearing":"length"},"Polygon"===n){const t=(0,T.calculateDistance)(p,e.measurement.lengthFormula);this.measureTooltipElements[this.measureTooltipElements.length-2].innerHTML=this.formatLengthValue(t,e.uom,!1),this.outputValues[this.measureTooltipElements.length-2]={value:t,type:"length"},this.perimeterTooltipCoord=Ae()(g),this.measureTooltips[this.measureTooltipElements.length-2].setPosition(this.perimeterTooltipCoord),this.measureTooltips[this.measureTooltipElements.length-2].setOffset([0,-7])}let y={...t};return y.properties=t.properties?{...t.properties}:{},y.properties.values=[{value:(d[n]||(()=>null))(),formattedValue:(m[n]||(()=>null))(),position:"Polygon"===n?(0,T.pointObjectToArray)((0,T.reproject)(u.getInteriorPoint().getCoordinates(),bt(e.map),"EPSG:4326")):Ae()(p),type:(a[0]||{}).type||(e.measurement.pointMeasureEnabled?"point":e.measurement.lineMeasureEnabled?"length":e.measurement.areaMeasureEnabled?"area":e.measurement.bearingMeasureEnabled?"bearing":void 0)},..."Polygon"===n?[{value:(0,T.calculateDistance)(p,e.measurement.lengthFormula),formattedValue:this.formatLengthValue((0,T.calculateDistance)(p,e.measurement.lengthFormula),e.uom,!1),position:Ae()(p),uom:e.uom,type:"length"}]:[]],[y,u]})),n=i.map((e=>e[0])),a=i.map((e=>e[1]));this.source.addFeatures(a.filter((e=>!!e)).map((e=>new qe.Z({geometry:e}))));let l=[...this.textLabels];n.map(((e,t)=>{var o,r;const i=!(null===(o=e.properties)||void 0===o||null===(r=o.values)||void 0===r||!r.find((e=>"bearing"===e.type))),n="Polygon"===e.geometry.type,a=n||i?0:1,p=n?e.geometry.coordinates[0]:e.geometry.coordinates,h=p.some((e=>!(0,Ve.wd)(e))),c=n?p.length-1:i?0:p.length;return e.geometry.textLabels=null!==s&&s===t&&h?e.geometry.textLabels.concat([{text:"0"}]):l.splice(0,c-a)||[],e})),this.props.changeGeometry(n),this.props.setTextLabels([...this.textLabels]);for(let e=0;e<this.measureTooltipElements.length;++e)this.measureTooltipElements[e]&&(this.measureTooltipElements[e].className="tooltip tooltip-static");for(let e=0;e<this.segmentOverlayElements.length;++e)this.segmentOverlayElements[e]&&(this.segmentOverlayElements[e].className="segment-overlay segment-overlay-static")})),wt(this,"updateMeasures",(e=>{const t=t=>{let{type:o,value:r}=t;return"length"===o?this.formatLengthValue(r,e.uom,!1):"area"===o?this.formatAreaValue(r,e.uom):this.formatLengthValue(r,e.uom,!0,e.measurement.trueBearing)};this.outputValues=this.outputValues||[],this.segmentOverlayElements=this.segmentOverlayElements||[],this.textLabels=this.textLabels||[];for(let e=0;e<this.outputValues.length;++e)this.outputValues[e]&&(this.measureTooltipElements[e].innerHTML=t(this.outputValues[e]));for(let e=0;e<this.segmentOverlayElements.length;++e){if(!this.segmentOverlayElements[e])continue;const o=t(this.segmentLengths[e]);let r=this.textLabels[e].text;const s=r.indexOf(" | ");r=r.replace(r.substring(0,-1!==s?s:r.length),o),this.segmentOverlayElements[e].innerHTML=r,this.textLabels[e].text=r}this.drawing||this.props.setTextLabels([...this.textLabels]);const o=(e.measurement.features||[]).map((e=>({...e,...e.properties?{properties:{...e.properties,values:(e.properties.values||[]).map((e=>({...e,formattedValue:t({type:e.type,value:e.value})})))}}:{}})));this.props.changeGeometry(o)})),wt(this,"addFeature",(e=>{let t=!1;this.source||(this.source=new Ue.Z,t=!0);let o=(0,T.reprojectGeoJson)(e,"EPSG:4326",bt(this.props.map)).geometry;const r=new qe.Z({geometry:X(o)});this.source.addFeature(r),t&&this.measureLayer.setSource(this.source)})),wt(this,"resetGeometry",(()=>{this.source.clear(),this.props.resetGeometry()})),wt(this,"saveDrawState",(()=>{var e,t,o,r;this.savedDrawState={textLabels:this.textLabels.slice(),segmentLengths:this.segmentLengths.slice(),measureTooltipsLength:null!==(e=null===(t=this.measureTooltips)||void 0===t?void 0:t.length)&&void 0!==e?e:0,segmentOverlaysLength:null!==(o=null===(r=this.segmentOverlays)||void 0===r?void 0:r.length)&&void 0!==o?o:0}})),wt(this,"discardDrawState",(()=>{this.savedDrawState=null})),wt(this,"restoreDrawState",(()=>{if(this.savedDrawState){this.textLabels=this.savedDrawState.textLabels,this.segmentLengths=this.savedDrawState.segmentLengths;for(let e=this.savedDrawState.measureTooltipsLength;e<this.measureTooltips.length;++e)this.props.map.removeOverlay(this.measureTooltips[e]),this.measureTooltipElements[e].parentNode.removeChild(this.measureTooltipElements[e]);for(let e=this.savedDrawState.segmentOverlaysLength;e<this.segmentOverlays.length;++e)this.props.map.removeOverlay(this.segmentOverlays[e]),this.segmentOverlayElements[e].parentNode.removeChild(this.segmentOverlayElements[e]);this.measureTooltips.splice(this.savedDrawState.measureTooltipsLength),this.measureTooltipElements.splice(this.savedDrawState.measureTooltipsLength),this.outputValues.splice(this.savedDrawState.measureTooltipsLength),this.segmentOverlays.splice(this.savedDrawState.segmentOverlaysLength),this.segmentOverlayElements.splice(this.savedDrawState.segmentOverlaysLength),this.curPolygonLength=void 0,this.curLineStringLength=void 0,this.savedDrawState=null}})),wt(this,"addDrawInteraction",(e=>{let t,o,{startEndPoint:r}=e.measurement;if(this.continueLineMsg=(0,Be.S$)(this.context.messages,"measureSupport.continueLine"),this.continuePolygonMsg=(0,Be.S$)(this.context.messages,"measureSupport.continuePolygon"),this.drawInteraction&&this.removeDrawInteraction(),!this.vector){this.source=new Ue.Z;let t=[new Ke.default({fill:new Xe.default({color:"rgba(255, 255, 255, 0.2)"}),stroke:new Ye.default({color:"#ffcc33",width:2}),image:new $e.default({radius:7,fill:new Xe.default({color:"#ffcc33"})})})],o=[],s=r||!0===r;if(s||void 0===r){let t=s?void 0===r?{}:r:e.startEndPoint;o=(0,Le.rm)(t.startPointOptions,t.endPointOptions)}const i=[...t,...o];this.vector=new We.Z({source:this.source,zIndex:1e6,style:i}),this.props.map.addLayer(this.vector)}o="Bearing"===e.measurement.geomType?"LineString":e.measurement.geomType,t=new ft({source:new Ue.Z,type:o,style:new Ke.default({fill:new Xe.default({color:"rgba(255, 255, 255, 0.2)"}),stroke:new Ye.default({color:"rgba(0, 0, 0, 0.5)",lineDash:[10,10],width:2}),image:new $e.default({radius:5,stroke:new Ye.default({color:"rgba(0, 0, 0, 0.7)"}),fill:new Xe.default({color:"rgba(255, 255, 255, 0.2)"})})})}),this.clickListener=this.props.map.on("click",(()=>this.updateMeasurementResults(this.props))),this.props.updateOnMouseMove&&this.props.map.on("pointermove",(()=>this.updateMeasurementResults(this.props))),this.props.map.on("pointermove",(e=>this.pointerMoveHandler(e))),t.on("drawstart",(e=>{var t,o;this.sketchFeature=e.feature,this.drawing=!0,this.textId=(null===(t=this.props.measurement)||void 0===t||null===(o=t.features)||void 0===o?void 0:o.length)||0,this.textLabels||(this.textLabels=[]),this.segmentLengths||(this.segmentLengths=[]),this.props.measurement.disableLabels||(this.saveDrawState(),this.createMeasureTooltip("Polygon"===this.props.measurement.geomType?[0,0]:void 0),"Polygon"===this.props.measurement.geomType&&this.createMeasureTooltip(),"Polygon"===this.props.measurement.geomType&&this.createSegmentLengthOverlay()),this.listener=this.sketchFeature.getGeometry().on("change",(e=>{let t,o,r=e.target;if(r instanceof K.ZP){o={value:this.getArea(r),type:"area"},t=this.formatAreaValue(o.value,this.props.uom),this.tooltipCoord=r.getInteriorPoint().getCoordinates();const e=r.getCoordinates()[0];let s=[];if(!this.props.measurement.disableLabels&&((void 0===this.curPolygonLength||this.curPolygonLength<e.length)&&(this.createSegmentLengthOverlay(),this.curPolygonLength=e.length),e.length>2)){s.push((0,T.midpoint)(e[e.length-1],e[e.length-2],!0)),s.push((0,T.midpoint)(e[e.length-2],e[e.length-3],!0));for(let t=0;t<s.length;++t){const o=e.slice(e.length-2-t,e.length-t),r=this.getLength(o,this.props),i=this.props.measurement&&this.props.measurement.showLengthAndBearingLabel&&" | "+(0,Ve.rp)((0,T.calculateAzimuth)(o[0],o[1],bt(this.props.map)),this.props.measurement.trueBearing)||"",n=this.formatLengthValue(r,this.props.uom,!1)+i;this.segmentOverlayElements[this.segmentOverlays.length-t-1].innerHTML=n,this.segmentOverlays[this.segmentOverlays.length-t-1].setPosition(s[t]),this.segmentLengths[this.segmentOverlays.length-t-1]={value:r,type:"length"},this.textLabels[this.segmentOverlays.length-t-1]={text:n,position:(0,T.pointObjectToArray)((0,T.reproject)(s[t],bt(this.props.map),"EPSG:4326")),type:this.props.measurement.geomType,textId:this.textId}}}}else if(r instanceof N.Z){const e=r.getCoordinates(),s=[e[e.length-2],e[e.length-1]];this.props.measurement.disableLabels||this.props.measurement.bearingMeasureEnabled||!(void 0===this.curLineStringLength||this.curLineStringLength<e.length)||(this.createSegmentLengthOverlay(),this.curLineStringLength=e.length);const i=this.getLength(e,this.props),n=this.getLength(s,this.props);if(t=this.formatLengthValue(i,this.props.uom,"Bearing"===this.props.measurement.geomType,this.props.measurement.trueBearing),this.tooltipCoord=r.getLastCoordinate(),!this.props.measurement.disableLabels&&!this.props.measurement.bearingMeasureEnabled){const e=this.props.measurement&&this.props.measurement.showLengthAndBearingLabel&&" | "+(0,Ve.rp)((0,T.calculateAzimuth)(s[0],s[1],bt(this.props.map)),this.props.measurement.trueBearing)||"",t=this.formatLengthValue(n,this.props.uom,"Bearing"===this.props.measurement.geomType,this.props.measurement.trueBearing)+e;Ae()(this.segmentOverlayElements).innerHTML=t,Ae()(this.segmentOverlays).setPosition((0,T.midpoint)(s[0],s[1],!0)),this.textLabels[this.segmentOverlays.length-1]={text:t,position:(0,T.pointObjectToArray)((0,T.reproject)((0,T.midpoint)(s[0],s[1],!0),bt(this.props.map),"EPSG:4326")),type:this.props.measurement.geomType,textId:this.textId},this.segmentLengths[this.segmentOverlays.length-1]={value:n,type:"Bearing"===this.props.measurement.geomType?"bearing":"length"}}o={value:i,type:"Bearing"===this.props.measurement.geomType?"bearing":"length"}}if(!this.props.measurement.disableLabels&&(Ae()(this.measureTooltipElements).innerHTML=t,Ae()(this.measureTooltips).setPosition(this.tooltipCoord),this.outputValues[this.outputValues.length-1]=o,r instanceof K.ZP)){const e=r.getCoordinates()[0],t=this.getLength(3===e.length?Re()(e):e,this.props);this.measureTooltipElements[this.measureTooltipElements.length-2].innerHTML=this.formatLengthValue(t,this.props.uom,!1),this.outputValues[this.measureTooltipElements.length-2]={value:t,type:"length"},this.perimeterTooltipCoord=r.getLastCoordinate(),this.measureTooltips[this.measureTooltipElements.length-2].setPosition(this.perimeterTooltipCoord)}}))})),t.on("drawend",(e=>{var t;this.drawing=!1;const o=Ze()(this.props.measurement,"features",[]),r=e.feature.getGeometry(),s=r.getCoordinates(),i=new Oe.Z,n={Point:()=>(0,T.reproject)(s,bt(this.props.map),"EPSG:4326"),LineString:()=>this.getLength(s,this.props),Polygon:()=>this.getArea(r),Bearing:()=>(0,T.calculateAzimuth)(s[0],s[1],bt(this.props.map))},a={LineString:()=>this.formatLengthValue(this.getLength(s,this.props),this.props.uom,!1),Polygon:()=>this.formatAreaValue(this.getArea(r),this.props.uom),Bearing:()=>this.formatLengthValue((0,T.calculateAzimuth)(s[0],s[1],bt(this.props.map)),this.props.uom,!0,this.props.measurement.trueBearing)};let l=(0,T.reprojectGeoJson)(i.writeFeatureObject(e.feature.clone()),bt(this.props.map),"EPSG:4326");l.properties=l.properties||{},l.properties.values=[{value:(n[this.props.measurement.geomType]||(()=>null))(),formattedValue:(a[this.props.measurement.geomType]||(()=>null))(),position:(0,T.pointObjectToArray)((0,T.reproject)("Polygon"===this.props.measurement.geomType?r.getInteriorPoint().getCoordinates():Ae()(s),bt(this.props.map),"EPSG:4326")),type:this.props.measurement.pointMeasureEnabled?"point":this.props.measurement.lineMeasureEnabled?"length":this.props.measurement.areaMeasureEnabled?"area":this.props.measurement.bearingMeasureEnabled?"bearing":void 0},..."Polygon"===this.props.measurement.geomType?[{value:(this.outputValues[this.measureTooltipElements.length-2]||{}).value||0,formattedValue:this.formatLengthValue((this.outputValues[this.measureTooltipElements.length-2]||{}).value||0,this.props.uom,!1),position:(0,T.pointObjectToArray)((0,T.reproject)(Ae()(s[0]),bt(this.props.map),"EPSG:4326")),uom:this.props.uom,type:"length"}]:[]];let p={...l};if(this.props.measurement.lineMeasureEnabled){let e=p.geometry.coordinates,t=(0,T.transformLineToArcs)(e);if(!this.props.measurement.disableLabels){this.removeLastSegment();for(let o=0;o<e.length-1;++o){const r=t[100*o+50];r&&(this.textLabels[this.segmentOverlays.length-e.length+1+o].position=r,this.segmentOverlays[this.segmentOverlays.length-e.length+1+o].setPosition((0,T.pointObjectToArray)((0,T.reproject)(r,"EPSG:4326",bt(this.props.map)))))}}p=(0,ze.t8)("geometry.coordinates",t,p)}else!this.props.measurement.disableLabels&&this.props.measurement.areaMeasureEnabled&&(this.textLabels.splice(this.segmentOverlays.length-2,1),this.props.map.removeOverlay(this.segmentOverlays[this.segmentOverlays.length-2]),this.segmentOverlayElements[this.segmentOverlays.length-2].parentNode.removeChild(this.segmentOverlayElements[this.segmentOverlays.length-2]),this.segmentOverlayElements.splice(this.segmentOverlays.length-2,1),this.segmentOverlays.splice(this.segmentOverlays.length-2,1));const h="bearing"===(null===(t=l.properties.values[0])||void 0===t?void 0:t.type)?"Bearing":l.geometry.type;if(l.geometry.textLabels=this.textLabels.filter((e=>e.type===h&&e.textId===this.textId)).map((e=>{let{textId:t,type:o,...r}=e;return r})),this.props.changeGeometry([...o,l]),this.props.setTextLabels([...this.textLabels]),this.addFeature(p),!this.props.measurement.disableLabels&&(Ae()(this.measureTooltipElements).className="tooltip tooltip-static",Ae()(this.measureTooltips).setOffset([0,-7]),"Polygon"===this.props.measurement.geomType&&(this.measureTooltipElements[this.measureTooltipElements.length-2].className="tooltip tooltip-static",this.measureTooltips[this.measureTooltipElements.length-2].setOffset([0,-7])),this.segmentOverlayElements))for(let e=0;e<this.segmentOverlayElements.length;++e)this.segmentOverlayElements[e]&&(this.segmentOverlayElements[e].className="segment-overlay segment-overlay-static");(0,vt.B)(this.listener),this.curPolygonLength=void 0,this.curLineStringLength=void 0,this.discardDrawState()})),this.props.map.addInteraction(t),this.createHelpTooltip(),this.drawInteraction=t,this.measureLayer=this.vector})),wt(this,"removeLastSegment",(()=>{this.textLabels.pop(),this.segmentLengths.pop(),this.props.map.removeOverlay(Ae()(this.segmentOverlays)),Ae()(this.segmentOverlayElements).parentNode.removeChild(Ae()(this.segmentOverlayElements)),this.segmentOverlays.pop(),this.segmentOverlayElements.pop()})),wt(this,"removeDrawInteraction",(()=>{null!==this.drawInteraction&&(this.removeHelpTooltip(),this.props.map.removeInteraction(this.drawInteraction),this.drawInteraction=null,this.sketchFeature=null,this.props.map.un("click",(()=>this.updateMeasurementResults(this.props)),this),(0,vt.B)(this.clickListener),this.props.updateOnMouseMove&&this.props.map.un("pointermove",(()=>this.updateMeasurementResults(this.props)),this))})),wt(this,"pointerMoveHandler",(function(e){if(e.dragging)return;let t=(0,Be.S$)(this.context.messages,"measureSupport.startDrawing");if(this.sketchFeature&&this.drawing){let e=this.sketchFeature.getGeometry();e instanceof K.ZP?t=this.continuePolygonMsg:e instanceof N.Z&&(t=this.continueLineMsg)}this.helpTooltipElement.innerHTML=t,this.helpTooltip.setPosition(e.coordinate),this.helpTooltipElement.classList.remove("hidden")})),wt(this,"updateMeasurementResults",(e=>{if(!this.sketchFeature)return;let t=this.sketchFeature.getGeometry().getCoordinates();if("Bearing"===e.measurement.geomType&&t.length>1&&t.length>2){for(this.drawInteraction.sketchCoords_=[t[0],t[1],t[0]];this.sketchFeature.getGeometry().getCoordinates().length>3;)this.drawInteraction.removeLastPoint();this.sketchFeature.getGeometry().setCoordinates([t[0],t[1]]),this.drawInteraction.sketchFeature_=this.sketchFeature,this.drawInteraction.finishDrawing()}})),wt(this,"reprojectedCoordinatesFrom4326",(e=>e.map((e=>{let t=(0,T.reproject)(e,"EPSG:4326",bt(this.props.map));return[t.x,t.y]})))),wt(this,"reprojectedCoordinatesIn4326",(e=>e.map((e=>{let t=(0,T.reproject)(e,bt(this.props.map),"EPSG:4326");return[t.x,t.y]})))),wt(this,"calculateGeodesicArea",(e=>{if(e.length>=4){const t=this.reprojectedCoordinatesIn4326(e);return Math.abs((0,_t.bg)(new K.ZP([t]),{projection:"EPSG:4326"}))}return 0})),wt(this,"createHelpTooltip",(()=>{this.removeHelpTooltip(),this.helpTooltipElement=document.createElement("div"),this.helpTooltipElement.className="tooltip hidden",this.helpTooltip=new He.Z({element:this.helpTooltipElement,offset:[15,0],positioning:"center-left"}),this.props.map.addOverlay(this.helpTooltip)})),wt(this,"createMeasureTooltip",(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,-15];e.measureTooltipElements||(e.measureTooltipElements=[]),e.measureTooltips||(e.measureTooltips=[]),e.outputValues||(e.outputValues=[]);let o=document.createElement("div");o.className="tooltip tooltip-measure",o.style.display=e.props.measurement.showLabel?"":"none",e.measureTooltipElements.push(o);let r=new He.Z({element:o,offset:t,positioning:"bottom-center"});e.props.map.addOverlay(r),e.measureTooltips.push(r),e.outputValues.push(null)})),wt(this,"createSegmentLengthOverlay",(e=>{this.segmentOverlayElements||(this.segmentOverlayElements=[]),this.segmentOverlays||(this.segmentOverlays=[]);let t=document.createElement("div");t.className="segment-overlay",t.style.display=this.props.measurement.showSegmentLengths&&!e?"":"none",this.segmentOverlayElements.push(t);let o=new He.Z({element:t,offset:[0,0],positioning:"center-center"});this.props.map.addOverlay(o),this.segmentOverlays.push(o)})),wt(this,"formatLengthValue",(function(t,o,r){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(r)return(0,Ve.rp)(t,s);const{label:i,unit:n}=o&&o.length,a=ke()((0,Ve.Ov)(t,"m",n),2);return e.props.formatNumber(a)+" "+i})),wt(this,"formatAreaValue",((e,t)=>{const{label:o,unit:r}=t&&t.area,s=ke()((0,Ve.Ov)(e,"sqm",r),2);return this.props.formatNumber(s)+" "+o})),wt(this,"removeHelpTooltip",(()=>{this.helpTooltipElement&&this.helpTooltipElement.parentNode&&this.helpTooltipElement.parentNode.removeChild(this.helpTooltipElement),this.helpTooltip&&this.props.map.removeOverlay(this.helpTooltip)})),wt(this,"removeMeasureTooltips",(()=>{(this.measureTooltips||[]).forEach((e=>{this.props.map.removeOverlay(e)}));let e=document.getElementsByClassName("tooltip-static")||[];for(let t=0;t<e.length;t++)e[t].parentNode.removeChild(e[t]);e=document.getElementsByClassName("tooltip-measure")||[];for(let t=0;t<e.length;t++)e[t].parentNode.removeChild(e[t]);this.measureTooltips=[],this.measureTooltipElements=[],this.outputValues=[]})),wt(this,"removeSegmentLengthOverlays",(()=>{(this.segmentOverlays||[]).forEach((e=>{this.props.map.removeOverlay(e)})),(this.segmentOverlayElements||[]).forEach((e=>{e.parentNode.removeChild(e)})),this.segmentOverlays=[],this.segmentOverlayElements=[]}))}UNSAFE_componentWillReceiveProps(e){if(this.measureTooltipElements&&e.measurement.showLabel!==this.props.measurement.showLabel)for(let t=0;t<this.measureTooltipElements.length;++t)this.measureTooltipElements[t]&&(this.measureTooltipElements[t].style.display=e.measurement.showLabel?"":"none");if(this.segmentOverlayElements&&e.measurement.showSegmentLengths)for(let t=0;t<this.segmentOverlayElements.length;++t)this.segmentOverlayElements[t]&&(this.segmentOverlayElements[t].style.display=e.measurement.showSegmentLengths?"":"none");(e.measurement.geomType&&e.measurement.geomType!==this.props.measurement.geomType||e.measurement.geomType&&(e.measurement.lineMeasureEnabled||e.measurement.areaMeasureEnabled||e.measurement.bearingMeasureEnabled)&&!this.props.enabled&&e.enabled)&&(this.restoreDrawState(),this.addDrawInteraction(e)),e.measurement.geomType||(this.removeDrawInteraction(),this.removeMeasureTooltips(),this.removeSegmentLengthOverlays(),this.textLabels=[],this.segmentLengths=[],this.props.map.removeLayer(this.measureLayer),this.vector=null,this.measureLayer=null,e.measurement.features&&e.measurement.features.length>0&&this.props.changeGeometry([]),e.measurement.textLabels&&e.measurement.textLabels.length>0&&this.props.setTextLabels([]),this.source&&(this.source.clear(),this.source=null));let t=this.props.measurement.features,o=e.measurement.features;e.measurement.updatedByUI&&!J()(t,o)?this.updateFeatures(e):e.measurement.updatedByUI&&!J()(this.props.uom,e.uom)&&this.updateMeasures(e)}render(){return null}}wt(Ct,"propTypes",{startEndPoint:i().object,map:i().object,measurement:i().object,enabled:i().bool,uom:i().object,formatNumber:i().func,changeMeasurementState:i().func,updateMeasures:i().func,resetGeometry:i().func,changeGeometry:i().func,updateOnMouseMove:i().bool,setTextLabels:i().func}),wt(Ct,"contextTypes",{messages:i().object}),wt(Ct,"defaultProps",{changeMeasurementState:()=>{},resetGeometry:()=>{},updateMeasures:()=>{},changeGeometry:()=>{},formatNumber:e=>e,setTextLabels:()=>{},startEndPoint:{startPointOptions:{radius:3,fillColor:"green",applyToPolygon:!0},endPointOptions:{radius:3,fillColor:"red",applyToPolygon:!0}},updateOnMouseMove:!1});var xt=o(97398),Et=o.n(xt),St=o(78426),Lt=o(40188),Pt=o(39850),Tt=o(13910),Ft=o(12868),Ot=o(86340),It=o(19530),Gt=o(67644),Mt=o(85386),kt=function(e){function t(t){var o=t||{};e.call(this,{element:document.createElement("div"),render:o.render||jt,target:o.target}),this.collapsed_=void 0===o.collapsed||o.collapsed,this.collapsible_=void 0===o.collapsible||o.collapsible,this.collapsible_||(this.collapsed_=!1);var r=void 0!==o.className?o.className:"ol-overviewmap",s=void 0!==o.tipLabel?o.tipLabel:"Overview map",i=void 0!==o.collapseLabel?o.collapseLabel:"";"string"==typeof i?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=i):this.collapseLabel_=i;var n=void 0!==o.label?o.label:"";"string"==typeof n?(this.label_=document.createElement("span"),this.label_.textContent=n):this.label_=n;var a=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_,l=document.createElement("button");l.setAttribute("type","button"),l.title=s,l.appendChild(a),(0,rt.oL)(l,Je.Z.CLICK,this.handleClick_,this),this.ovmapDiv_=document.createElement("div"),this.ovmapDiv_.className="ol-overviewmap-map",this.ovmap_=new g.default({controls:new St.Z,interactions:new St.Z,view:o.view});var p=this.ovmap_;o.layers&&o.layers.forEach(function(e){p.addLayer(e)}.bind(this));var h=document.createElement("div");h.className="ol-overviewmap-box",h.style.boxSizing="border-box",this.boxOverlay_=new He.Z({position:[0,0],positioning:Ft.Z.BOTTOM_LEFT,element:h}),this.ovmap_.addOverlay(this.boxOverlay_);var c=r+" "+Gt.XV+" "+Gt.hg+(this.collapsed_&&this.collapsible_?" "+Gt.hN:"")+(this.collapsible_?"":" ol-uncollapsible"),u=this.element;u.className=c,u.appendChild(this.ovmapDiv_),u.appendChild(l);var d=this,m=this.boxOverlay_,y=this.boxOverlay_.getElement(),f=function(e){var t,o={clientX:(t=e).clientX-y.offsetWidth/2,clientY:t.clientY+y.offsetHeight/2},r=p.getEventCoordinate(o);m.setPosition(r)},v=function(e){var t=p.getEventCoordinate(e);d.getMap().getView().setCenter(t),window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",v)};y.addEventListener("mousedown",(function(){window.addEventListener("mousemove",f),window.addEventListener("mouseup",v)}))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.setMap=function(t){var o=this.getMap();if(t!==o){if(o){var r=o.getView();r&&this.unbindView_(r),this.ovmap_.setTarget(null)}if(e.prototype.setMap.call(this,t),t){this.ovmap_.setTarget(this.ovmapDiv_),this.listenerKeys.push((0,rt.oL)(t,Tt.Z.PROPERTYCHANGE,this.handleMapPropertyChange_,this)),0===this.ovmap_.getLayers().getLength()&&this.ovmap_.setLayerGroup(t.getLayerGroup());var s=t.getView();s&&(this.bindView_(s),s.isDef()&&(this.ovmap_.updateSize(),this.resetExtent_()))}}},t.prototype.handleMapPropertyChange_=function(e){if(e.key===Pt.Z.VIEW){var t=e.oldValue;t&&this.unbindView_(t);var o=this.getMap().getView();this.bindView_(o)}},t.prototype.bindView_=function(e){(0,rt.oL)(e,(0,tt.v_)(Ot.Z.ROTATION),this.handleRotationChanged_,this)},t.prototype.unbindView_=function(e){(0,rt.Ev)(e,(0,tt.v_)(Ot.Z.ROTATION),this.handleRotationChanged_,this)},t.prototype.handleRotationChanged_=function(){this.ovmap_.getView().setRotation(this.getMap().getView().getRotation())},t.prototype.validateExtent_=function(){var e=this.getMap(),t=this.ovmap_;if(e.isRendered()&&t.isRendered()){var o=e.getSize(),r=e.getView().calculateExtent(o),s=t.getSize(),i=t.getView().calculateExtent(s),n=t.getPixelFromCoordinate((0,w.rL)(r)),a=t.getPixelFromCoordinate((0,w.w$)(r)),l=Math.abs(n[0]-a[0]),p=Math.abs(n[1]-a[1]),h=s[0],c=s[1];l<.1*h||p<.1*c||l>.75*h||p>.75*c?this.resetExtent_():(0,w.r4)(i,r)||this.recenter_()}},t.prototype.resetExtent_=function(){var e=this.getMap(),t=this.ovmap_,o=e.getSize(),r=e.getView().calculateExtent(o),s=t.getView(),i=Math.log(7.5)/Math.LN2,n=1/(.1*Math.pow(2,i/2));(0,w.H9)(r,n),s.fit(r)},t.prototype.recenter_=function(){var e=this.getMap(),t=this.ovmap_,o=e.getView();t.getView().setCenter(o.getCenter())},t.prototype.updateBox_=function(){var e=this.getMap(),t=this.ovmap_;if(e.isRendered()&&t.isRendered()){var o=e.getSize(),r=e.getView(),s=t.getView(),i=r.getRotation(),n=this.boxOverlay_,a=this.boxOverlay_.getElement(),l=r.calculateExtent(o),p=s.getResolution(),h=(0,w.hC)(l),c=(0,w.Xv)(l),u=this.calculateCoordinateRotate_(i,h);n.setPosition(u),a&&(a.style.width=Math.abs((h[0]-c[0])/p)+"px",a.style.height=Math.abs((c[1]-h[1])/p)+"px")}},t.prototype.calculateCoordinateRotate_=function(e,t){var o,r=this.getMap().getView().getCenter();return r&&(o=[t[0]-r[0],t[1]-r[1]],(0,ot.U1)(o,e),(0,ot.IH)(o,r)),o},t.prototype.handleClick_=function(e){e.preventDefault(),this.handleToggle_()},t.prototype.handleToggle_=function(){this.element.classList.toggle(Gt.hN),this.collapsed_?(0,Mt.$H)(this.collapseLabel_,this.label_):(0,Mt.$H)(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_;var e=this.ovmap_;this.collapsed_||e.isRendered()||(e.updateSize(),this.resetExtent_(),(0,rt.Vx)(e,Lt.Z.POSTRENDER,(function(e){this.updateBox_()}),this))},t.prototype.getCollapsible=function(){return this.collapsible_},t.prototype.setCollapsible=function(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),!e&&this.collapsed_&&this.handleToggle_())},t.prototype.setCollapsed=function(e){this.collapsible_&&this.collapsed_!==e&&this.handleToggle_()},t.prototype.getCollapsed=function(){return this.collapsed_},t.prototype.getOverviewMap=function(){return this.ovmap_},t}(It.Z);function jt(e){this.validateExtent_(),this.updateBox_()}const Zt=kt;function Dt(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}o(55691);const Rt={className:"ol-overviewmap ol-custom-overviewmap",collapseLabel:"",label:"",collapsed:!0,collapsible:!0};class Nt extends S().Component{constructor(){super(...arguments),Dt(this,"dragstart",(e=>{this.dragging||(this.dragBox=this.box.cloneNode(),this.dragBox.setAttribute("class","ol-overview-dargbox"),this.dragBox.style.position="relative",this.box.appendChild(this.dragBox),""===this.box.style.top?this.offsetStartTop=0:this.offsetStartTop=parseInt(this.box.style.top.slice(0,-2),10),""===this.box.style.left?this.offsetStartLeft=0:this.offsetStartLeft=parseInt(this.box.style.left.slice(0,-2),10),this.mouseStartTop=e.pageY,this.mouseStartLeft=e.pageX,this.dragging=!0)})),Dt(this,"draggingel",(e=>{!0===this.dragging&&(this.dragBox.style.top=this.offsetStartTop+e.pageY-this.mouseStartTop+"px",this.dragBox.style.left=this.offsetStartLeft+e.pageX-this.mouseStartLeft+"px",e.stopPropagation(),e.preventDefault())})),Dt(this,"dragend",(()=>{if(!0===this.dragging){let e={};e.top=""===this.dragBox.style.top?0:parseInt(this.dragBox.style.top.slice(0,-2),10),e.left=""===this.dragBox.style.left?0:parseInt(this.dragBox.style.left.slice(0,-2),10),this.box.removeChild(this.dragBox),delete this.dragBox,this.dragging=!1,this.setNewExtent(e)}})),Dt(this,"setNewExtent",(e=>{let t=this.box.offsetWidth,o=this.box.offsetHeight,r=this.props.map.getSize(),s=e.left*Math.abs(r[0]/t),i=e.top*Math.abs(r[1]/o);s=Et()(s)?s:0,i=Et()(i)?i:0;let n=[0+s,r[1]+i],a=[r[0]+s,0+i],l=this.props.map.getCoordinateFromPixel(n)||[0,0],p=this.props.map.getCoordinateFromPixel(a)||[0,0],h=[l[0],l[1],p[0],p[1]];this.props.map.getView().fit(h,r,{nearest:!0})}))}componentDidMount(){let e=[];this.props.layers.forEach((t=>{e.push(me.default.createLayer(t.type,t.options||{}))}));let t=P()({},Rt,this.props.overviewOpt,{layers:e});this.overview=new Zt(t),this.props.map&&this.overview.setMap(this.props.map),this.box=this.overview.element.getElementsByClassName("ol-overviewmap-box").item(0),this.box.onmousedown=e=>{this.dragstart(e),this.box.onmousemove=e=>{this.draggingel(e)},this.overview.element.onmousemove=e=>{this.draggingel(e)},this.box.onmouseup=()=>{this.dragend(),this.overview.element.onmousemove=null,this.box.onmousemove=null,this.box.onmouseup=null}}}render(){return null}}Dt(Nt,"displayName","Overview"),Dt(Nt,"propTypes",{id:i().string,map:i().object,overviewOpt:i().object,layers:i().array}),Dt(Nt,"defaultProps",{id:"overview",overviewOpt:{},layers:[{type:"osm",options:{}}]});var At=o(38906),Vt="units",zt="degrees",Bt="metric",Ht=[1,2,5],Ut=function(e){function t(t){var o=t||{},r=void 0!==o.className?o.className:"ol-scale-line";e.call(this,{element:document.createElement("div"),render:o.render||Wt,target:o.target}),this.innerElement_=document.createElement("div"),this.innerElement_.className=r+"-inner",this.element.className=r+" "+Gt.XV,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=void 0!==o.minWidth?o.minWidth:64,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",(0,rt.oL)(this,(0,tt.v_)(Vt),this.handleUnitsChanged_,this),this.setUnits(o.units||Bt)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getUnits=function(){return this.get(Vt)},t.prototype.handleUnitsChanged_=function(){this.updateElement_()},t.prototype.setUnits=function(e){this.set(Vt,e)},t.prototype.updateElement_=function(){var e=this.viewState_;if(e){var t=e.center,o=e.projection,r=this.getUnits(),s=r==zt?_.default.DEGREES:_.default.METERS,i=(0,f._Q)(o,e.resolution,t,s);o.getUnits()!=_.default.DEGREES&&o.getMetersPerUnit()&&s==_.default.METERS&&(i*=o.getMetersPerUnit());var n=this.minWidth_*i,a="";if(r==zt){var l=_.METERS_PER_UNIT[_.default.DEGREES];o.getUnits()==_.default.DEGREES?n*=l:i/=l,n<l/60?(a="",i*=3600):n<l?(a="",i*=60):a=""}else"imperial"==r?n<.9144?(a="in",i/=.0254):n<1609.344?(a="ft",i/=.3048):(a="mi",i/=1609.344):"nautical"==r?(i/=1852,a="nm"):r==Bt?n<.001?(a="m",i*=1e6):n<1?(a="mm",i*=1e3):n<1e3?a="m":(a="km",i/=1e3):"us"==r?n<.9144?(a="in",i*=39.37):n<1609.344?(a="ft",i/=.30480061):(a="mi",i/=1609.3472):(0,At.h)(!1,33);for(var p,h,c=3*Math.floor(Math.log(this.minWidth_*i)/Math.log(10));;){if(p=Ht[(c%3+3)%3]*Math.pow(10,Math.floor(c/3)),h=Math.round(p/i),isNaN(h))return this.element.style.display="none",void(this.renderedVisible_=!1);if(h>=this.minWidth_)break;++c}var u=p+" "+a;this.renderedHTML_!=u&&(this.innerElement_.innerHTML=u,this.renderedHTML_=u),this.renderedWidth_!=h&&(this.innerElement_.style.width=h+"px",this.renderedWidth_=h),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},t}(It.Z);function Wt(e){var t=e.frameState;this.viewState_=t?t.viewState:null,this.updateElement_()}const qt=Ut;function Kt(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class Xt extends S().Component{componentDidMount(){this.scalebar=new qt(P()({},this.props,this.props.container?{target:document.querySelector(this.props.container)}:{})),this.props.map&&this.props.map.addControl(this.scalebar)}componentWillUnmount(){if(this.props.container&&document.querySelector(".ol-scale-line"))try{document.querySelector(this.props.container).removeChild(document.querySelector(".ol-scale-line"))}catch(e){}}render(){return null}}Kt(Xt,"propTypes",{map:i().object,className:i().string,minWidth:i().number,units:i().oneOf(["degrees","imperial","nautical","metric","us"]),container:i().string}),Kt(Xt,"defaultProps",{map:null,className:"ol-scale-line",minWidth:64,units:"metric"});var Yt=o(57043),$t=o.n(Yt),Jt=o(91175),Qt=o.n(Jt),eo=o(12571),to=o.n(eo),oo=o(63105),ro=o.n(oo),so=o(55877),io=o.n(so),no=o(89565),ao=o(98090),lo=o(15565),po=o(79682),ho=function(e){function t(t,o,r){e.call(this,t),this.features=o,this.coordinate=r}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(st.ZP),co=function(e){function t(t){var o,r=t||{};if(e.call(this,r),this.lastCoordinate_=null,this.features_=void 0!==r.features?r.features:null,r.layers)if("function"==typeof r.layers)o=r.layers;else{var s=r.layers;o=function(e){return(0,po.q9)(s,e)}}else o=nt.uX;this.layerFilter_=o,this.hitTolerance_=r.hitTolerance?r.hitTolerance:0,this.lastFeature_=null,(0,rt.oL)(this,(0,tt.v_)(pt.Z.ACTIVE),this.handleActiveChanged_,this)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.handleDownEvent=function(e){if(this.lastFeature_=this.featuresAtPixel_(e.pixel,e.map),!this.lastCoordinate_&&this.lastFeature_){this.lastCoordinate_=e.coordinate,this.handleMoveEvent(e);var t=this.features_||new St.Z([this.lastFeature_]);return this.dispatchEvent(new ho("translatestart",t,e.coordinate)),!0}return!1},t.prototype.handleUpEvent=function(e){if(this.lastCoordinate_){this.lastCoordinate_=null,this.handleMoveEvent(e);var t=this.features_||new St.Z([this.lastFeature_]);return this.dispatchEvent(new ho("translateend",t,e.coordinate)),!0}return!1},t.prototype.handleDragEvent=function(e){if(this.lastCoordinate_){var t=e.coordinate,o=t[0]-this.lastCoordinate_[0],r=t[1]-this.lastCoordinate_[1],s=this.features_||new St.Z([this.lastFeature_]);s.forEach((function(e){var t=e.getGeometry();t.translate(o,r),e.setGeometry(t)})),this.lastCoordinate_=t,this.dispatchEvent(new ho("translating",s,t))}},t.prototype.handleMoveEvent=function(e){var t=e.map.getViewport();this.featuresAtPixel_(e.pixel,e.map)?(t.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),t.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):t.classList.remove("ol-grab","ol-grabbing")},t.prototype.featuresAtPixel_=function(e,t){return t.forEachFeatureAtPixel(e,function(e){if(!this.features_||(0,po.q9)(this.features_.getArray(),e))return e}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})},t.prototype.getHitTolerance=function(){return this.hitTolerance_},t.prototype.setHitTolerance=function(e){this.hitTolerance_=e},t.prototype.setMap=function(t){var o=this.getMap();e.prototype.setMap.call(this,t),this.updateState_(o)},t.prototype.handleActiveChanged_=function(){this.updateState_(null)},t.prototype.updateState_=function(e){var t=this.getMap(),o=this.getActive();t&&o||(t=t||e)&&t.getViewport().classList.remove("ol-grab","ol-grabbing")},t}(lt.Z);const uo=co;var mo=o(49179),go=o(19629),yo=o(25753),fo=o(73101),vo="modifyend",_o=function(e){function t(t,o,r){e.call(this,t),this.features=o,this.mapBrowserEvent=r}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(st.ZP),wo=function(e){function t(t){var o,r;if(e.call(this,t),this.condition_=t.condition?t.condition:it.Xp,this.defaultDeleteCondition_=function(e){return(0,it.Ko)(e)&&(0,it.Kf)(e)},this.deleteCondition_=t.deleteCondition?t.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=t.insertVertexCondition?t.insertVertexCondition:it.Bx,this.vertexFeature_=null,this.vertexSegments_=null,this.lastPixel_=[0,0],this.ignoreNextSingleClick_=!1,this.modified_=!1,this.rBush_=new fo.Z,this.pixelTolerance_=void 0!==t.pixelTolerance?t.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new We.Z({source:new Ue.Z({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.style?t.style:(o=(0,Ke.createEditingStyle)(),function(e,t){return o[B.Z.POINT]}),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_,LineString:this.writeLineStringGeometry_,LinearRing:this.writeLineStringGeometry_,Polygon:this.writePolygonGeometry_,MultiPoint:this.writeMultiPointGeometry_,MultiLineString:this.writeMultiLineStringGeometry_,MultiPolygon:this.writeMultiPolygonGeometry_,Circle:this.writeCircleGeometry_,GeometryCollection:this.writeGeometryCollectionGeometry_},this.source_=null,t.source?(this.source_=t.source,r=new St.Z(this.source_.getFeatures()),(0,rt.oL)(this.source_,yo.Z.ADDFEATURE,this.handleSourceAdd_,this),(0,rt.oL)(this.source_,yo.Z.REMOVEFEATURE,this.handleSourceRemove_,this)):r=t.features,!r)throw new Error("The modify interaction requires features or a source");this.features_=r,this.features_.forEach(this.addFeature_.bind(this)),(0,rt.oL)(this.features_,go.Z.ADD,this.handleFeatureAdd_,this),(0,rt.oL)(this.features_,go.Z.REMOVE,this.handleFeatureRemove_,this),this.lastPointerEvent_=null}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.addFeature_=function(e){var t=e.getGeometry();t&&t.getType()in this.SEGMENT_WRITERS_&&this.SEGMENT_WRITERS_[t.getType()].call(this,e,t);var o=this.getMap();o&&o.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,o),(0,rt.oL)(e,Je.Z.CHANGE,this.handleFeatureChange_,this)},t.prototype.willModifyFeatures_=function(e){this.modified_||(this.modified_=!0,this.dispatchEvent(new _o("modifystart",this.features_,e)))},t.prototype.removeFeature_=function(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),(0,rt.Ev)(e,Je.Z.CHANGE,this.handleFeatureChange_,this)},t.prototype.removeFeatureSegmentData_=function(e){var t=this.rBush_,o=[];t.forEach((function(t){e===t.feature&&o.push(t)}));for(var r=o.length-1;r>=0;--r)t.remove(o[r])},t.prototype.setActive=function(t){this.vertexFeature_&&!t&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.prototype.setActive.call(this,t)},t.prototype.setMap=function(t){this.overlay_.setMap(t),e.prototype.setMap.call(this,t)},t.prototype.getOverlay=function(){return this.overlay_},t.prototype.handleSourceAdd_=function(e){e.feature&&this.features_.push(e.feature)},t.prototype.handleSourceRemove_=function(e){e.feature&&this.features_.remove(e.feature)},t.prototype.handleFeatureAdd_=function(e){this.addFeature_(e.element)},t.prototype.handleFeatureChange_=function(e){if(!this.changingFeature_){var t=e.target;this.removeFeature_(t),this.addFeature_(t)}},t.prototype.handleFeatureRemove_=function(e){var t=e.element;this.removeFeature_(t)},t.prototype.writePointGeometry_=function(e,t){var o=t.getCoordinates(),r={feature:e,geometry:t,segment:[o,o]};this.rBush_.insert(t.getExtent(),r)},t.prototype.writeMultiPointGeometry_=function(e,t){for(var o=t.getCoordinates(),r=0,s=o.length;r<s;++r){var i=o[r],n={feature:e,geometry:t,depth:[r],index:r,segment:[i,i]};this.rBush_.insert(t.getExtent(),n)}},t.prototype.writeLineStringGeometry_=function(e,t){for(var o=t.getCoordinates(),r=0,s=o.length-1;r<s;++r){var i=o.slice(r,r+2),n={feature:e,geometry:t,index:r,segment:i};this.rBush_.insert((0,w.hI)(i),n)}},t.prototype.writeMultiLineStringGeometry_=function(e,t){for(var o=t.getCoordinates(),r=0,s=o.length;r<s;++r)for(var i=o[r],n=0,a=i.length-1;n<a;++n){var l=i.slice(n,n+2),p={feature:e,geometry:t,depth:[r],index:n,segment:l};this.rBush_.insert((0,w.hI)(l),p)}},t.prototype.writePolygonGeometry_=function(e,t){for(var o=t.getCoordinates(),r=0,s=o.length;r<s;++r)for(var i=o[r],n=0,a=i.length-1;n<a;++n){var l=i.slice(n,n+2),p={feature:e,geometry:t,depth:[r],index:n,segment:l};this.rBush_.insert((0,w.hI)(l),p)}},t.prototype.writeMultiPolygonGeometry_=function(e,t){for(var o=t.getCoordinates(),r=0,s=o.length;r<s;++r)for(var i=o[r],n=0,a=i.length;n<a;++n)for(var l=i[n],p=0,h=l.length-1;p<h;++p){var c=l.slice(p,p+2),u={feature:e,geometry:t,depth:[n,r],index:p,segment:c};this.rBush_.insert((0,w.hI)(c),u)}},t.prototype.writeCircleGeometry_=function(e,t){var o=t.getCenter(),r={feature:e,geometry:t,index:0,segment:[o,o]},s={feature:e,geometry:t,index:1,segment:[o,o]},i=[r,s];r.featureSegments=s.featureSegments=i,this.rBush_.insert((0,w.HK)(o),r),this.rBush_.insert(t.getExtent(),s)},t.prototype.writeGeometryCollectionGeometry_=function(e,t){for(var o=t.getGeometriesArray(),r=0;r<o.length;++r)this.SEGMENT_WRITERS_[o[r].getType()].call(this,e,o[r])},t.prototype.createOrUpdateVertexFeature_=function(e){var t=this.vertexFeature_;return t?t.getGeometry().setCoordinates(e):(t=new qe.Z(new R.Z(e)),this.vertexFeature_=t,this.overlay_.getSource().addFeature(t)),t},t.prototype.handleEvent=function(t){return!t.pointerEvent||(this.lastPointerEvent_=t,t.map.getView().getInteracting()||t.type!=Qe.Z.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(t),this.vertexFeature_&&this.deleteCondition_(t)&&(o=!(t.type!=Qe.Z.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),t.type==Qe.Z.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),e.prototype.handleEvent.call(this,t)&&!o);var o},t.prototype.handleDragEvent=function(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e);for(var t=e.coordinate,o=0,r=this.dragSegments_.length;o<r;++o){for(var s=this.dragSegments_[o],i=s[0],n=i.depth,a=i.geometry,l=void 0,p=i.segment,h=s[1];t.length<a.getStride();)t.push(p[h][t.length]);switch(a.getType()){case B.Z.POINT:l=t,p[0]=p[1]=t;break;case B.Z.MULTI_POINT:(l=a.getCoordinates())[i.index]=t,p[0]=p[1]=t;break;case B.Z.LINE_STRING:(l=a.getCoordinates())[i.index+h]=t,p[h]=t;break;case B.Z.MULTI_LINE_STRING:case B.Z.POLYGON:(l=a.getCoordinates())[n[0]][i.index+h]=t,p[h]=t;break;case B.Z.MULTI_POLYGON:(l=a.getCoordinates())[n[1]][n[0]][i.index+h]=t,p[h]=t;break;case B.Z.CIRCLE:p[0]=p[1]=t,0===i.index?(this.changingFeature_=!0,a.setCenter(t),this.changingFeature_=!1):(this.changingFeature_=!0,a.setRadius((0,ot.TE)(a.getCenter(),t)),this.changingFeature_=!1)}l&&this.setGeometryCoordinates_(a,l)}this.createOrUpdateVertexFeature_(t)},t.prototype.handleDownEvent=function(e){if(!this.condition_(e))return!1;this.handlePointerAtPixel_(e.pixel,e.map);var t=e.map.getCoordinateFromPixel(e.pixel);this.dragSegments_.length=0,this.modified_=!1;var o=this.vertexFeature_;if(o){var r=[],s=o.getGeometry().getCoordinates(),i=(0,w.hI)([s]),n=this.rBush_.getInExtent(i),a={};n.sort(bo);for(var l=0,p=n.length;l<p;++l){var h=n[l],c=h.segment,u=(0,mo.sq)(h.feature),d=h.depth;if(d&&(u+="-"+d.join("-")),a[u]||(a[u]=new Array(2)),h.geometry.getType()===B.Z.CIRCLE&&1===h.index){var m=xo(t,h);(0,ot.fS)(m,s)&&!a[u][0]&&(this.dragSegments_.push([h,0]),a[u][0]=h)}else if((0,ot.fS)(c[0],s)&&!a[u][0])this.dragSegments_.push([h,0]),a[u][0]=h;else if((0,ot.fS)(c[1],s)&&!a[u][1]){if((h.geometry.getType()===B.Z.LINE_STRING||h.geometry.getType()===B.Z.MULTI_LINE_STRING)&&a[u][0]&&0===a[u][0].index)continue;this.dragSegments_.push([h,1]),a[u][1]=h}else this.insertVertexCondition_(e)&&(0,mo.sq)(c)in this.vertexSegments_&&!a[u][0]&&!a[u][1]&&r.push([h,s])}r.length&&this.willModifyFeatures_(e);for(var g=r.length-1;g>=0;--g)this.insertVertex_.apply(this,r[g])}return!!this.vertexFeature_},t.prototype.handleUpEvent=function(e){for(var t=this.dragSegments_.length-1;t>=0;--t){var o=this.dragSegments_[t][0],r=o.geometry;if(r.getType()===B.Z.CIRCLE){var s=r.getCenter(),i=o.featureSegments[0],n=o.featureSegments[1];i.segment[0]=i.segment[1]=s,n.segment[0]=n.segment[1]=s,this.rBush_.update((0,w.HK)(s),i),this.rBush_.update(r.getExtent(),n)}else this.rBush_.update((0,w.hI)(o.segment),o)}return this.modified_&&(this.dispatchEvent(new _o(vo,this.features_,e)),this.modified_=!1),!1},t.prototype.handlePointerMove_=function(e){this.lastPixel_=e.pixel,this.handlePointerAtPixel_(e.pixel,e.map)},t.prototype.handlePointerAtPixel_=function(e,t){var o=t.getCoordinateFromPixel(e),r=(0,w.f3)((0,w.HK)(o),t.getView().getResolution()*this.pixelTolerance_),s=this.rBush_.getInExtent(r);if(s.length>0){s.sort((function(e,t){return Co(o,e)-Co(o,t)}));var i=s[0],n=i.segment,a=xo(o,i),l=t.getPixelFromCoordinate(a),p=(0,ot.TE)(e,l);if(p<=this.pixelTolerance_){var h={};if(i.geometry.getType()===B.Z.CIRCLE&&1===i.index)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(a);else{var c=t.getPixelFromCoordinate(n[0]),u=t.getPixelFromCoordinate(n[1]),d=(0,ot.bI)(l,c),m=(0,ot.bI)(l,u);p=Math.sqrt(Math.min(d,m)),this.snappedToVertex_=p<=this.pixelTolerance_,this.snappedToVertex_&&(a=d>m?n[1]:n[0]),this.createOrUpdateVertexFeature_(a);for(var g=1,y=s.length;g<y;++g){var f=s[g].segment;if(!((0,ot.fS)(n[0],f[0])&&(0,ot.fS)(n[1],f[1])||(0,ot.fS)(n[0],f[1])&&(0,ot.fS)(n[1],f[0])))break;h[(0,mo.sq)(f)]=!0}}return h[(0,mo.sq)(n)]=!0,void(this.vertexSegments_=h)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)},t.prototype.insertVertex_=function(e,t){for(var o,r=e.segment,s=e.feature,i=e.geometry,n=e.depth,a=e.index;t.length<i.getStride();)t.push(0);switch(i.getType()){case B.Z.MULTI_LINE_STRING:case B.Z.POLYGON:(o=i.getCoordinates())[n[0]].splice(a+1,0,t);break;case B.Z.MULTI_POLYGON:(o=i.getCoordinates())[n[1]][n[0]].splice(a+1,0,t);break;case B.Z.LINE_STRING:(o=i.getCoordinates()).splice(a+1,0,t);break;default:return}this.setGeometryCoordinates_(i,o);var l=this.rBush_;l.remove(e),this.updateSegmentIndices_(i,a,n,1);var p={segment:[r[0],t],feature:s,geometry:i,depth:n,index:a};l.insert((0,w.hI)(p.segment),p),this.dragSegments_.push([p,1]);var h={segment:[t,r[1]],feature:s,geometry:i,depth:n,index:a+1};l.insert((0,w.hI)(h.segment),h),this.dragSegments_.push([h,0]),this.ignoreNextSingleClick_=!0},t.prototype.removePoint=function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=Qe.Z.POINTERDRAG){var e=this.lastPointerEvent_;return this.willModifyFeatures_(e),this.removeVertex_(),this.dispatchEvent(new _o(vo,this.features_,e)),this.modified_=!1,!0}return!1},t.prototype.removeVertex_=function(){var e,t,o,r,s,i,n,a,l,p,h,c=this.dragSegments_,u={},d=!1;for(s=c.length-1;s>=0;--s)p=(o=c[s])[0],h=(0,mo.sq)(p.feature),p.depth&&(h+="-"+p.depth.join("-")),h in u||(u[h]={}),0===o[1]?(u[h].right=p,u[h].index=p.index):1==o[1]&&(u[h].left=p,u[h].index=p.index+1);for(h in u){switch(l=u[h].right,n=u[h].left,(a=(i=u[h].index)-1)<0&&(a=0),e=t=(r=(p=void 0!==n?n:l).geometry).getCoordinates(),d=!1,r.getType()){case B.Z.MULTI_LINE_STRING:t[p.depth[0]].length>2&&(t[p.depth[0]].splice(i,1),d=!0);break;case B.Z.LINE_STRING:t.length>2&&(t.splice(i,1),d=!0);break;case B.Z.MULTI_POLYGON:e=e[p.depth[1]];case B.Z.POLYGON:(e=e[p.depth[0]]).length>4&&(i==e.length-1&&(i=0),e.splice(i,1),d=!0,0===i&&(e.pop(),e.push(e[0]),a=e.length-1))}if(d){this.setGeometryCoordinates_(r,t);var m=[];if(void 0!==n&&(this.rBush_.remove(n),m.push(n.segment[0])),void 0!==l&&(this.rBush_.remove(l),m.push(l.segment[1])),void 0!==n&&void 0!==l){var g={depth:p.depth,feature:p.feature,geometry:p.geometry,index:a,segment:m};this.rBush_.insert((0,w.hI)(g.segment),g)}this.updateSegmentIndices_(r,i,p.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),c.length=0}}return d},t.prototype.setGeometryCoordinates_=function(e,t){this.changingFeature_=!0,e.setCoordinates(t),this.changingFeature_=!1},t.prototype.updateSegmentIndices_=function(e,t,o,r){this.rBush_.forEachInExtent(e.getExtent(),(function(s){s.geometry===e&&(void 0===o||void 0===s.depth||(0,po.fS)(s.depth,o))&&s.index>t&&(s.index+=r)}))},t}(lt.Z);function bo(e,t){return e.index-t.index}function Co(e,t){var o=t.geometry;if(o.getType()===B.Z.CIRCLE){var r=o;if(1===t.index){var s=(0,ot.bI)(r.getCenter(),e),i=Math.sqrt(s)-r.getRadius();return i*i}}return(0,ot.Bs)(e,t.segment)}function xo(e,t){var o=t.geometry;return o.getType()===B.Z.CIRCLE&&1===t.index?o.getClosestPoint(e):(0,ot.oL)(e,t.segment)}const Eo=wo;var So=o(47588),Lo=o(13580),Po=function(e){function t(t,o,r,s){e.call(this,t),this.selected=o,this.deselected=r,this.mapBrowserEvent=s}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(st.ZP),To=function(e){function t(t){e.call(this,{handleEvent:Fo});var o=t||{};this.condition_=o.condition?o.condition:it.Kf,this.addCondition_=o.addCondition?o.addCondition:it.Fi,this.removeCondition_=o.removeCondition?o.removeCondition:it.Fi,this.toggleCondition_=o.toggleCondition?o.toggleCondition:it.vY,this.multi_=!!o.multi&&o.multi,this.filter_=o.filter?o.filter:nt.uX,this.hitTolerance_=o.hitTolerance?o.hitTolerance:0;var r,s,i=new We.Z({source:new Ue.Z({useSpatialIndex:!1,features:o.features,wrapX:o.wrapX}),style:o.style?o.style:(s=(0,Ke.createEditingStyle)(),(0,po.l7)(s[B.Z.POLYGON],s[B.Z.LINE_STRING]),(0,po.l7)(s[B.Z.GEOMETRY_COLLECTION],s[B.Z.LINE_STRING]),function(e,t){return e.getGeometry()?s[e.getGeometry().getType()]:null}),updateWhileAnimating:!0,updateWhileInteracting:!0});if(this.featureOverlay_=i,o.layers)if("function"==typeof o.layers)r=o.layers;else{var n=o.layers;r=function(e){return(0,po.q9)(n,e)}}else r=nt.uX;this.layerFilter_=r,this.featureLayerAssociation_={};var a=this.getFeatures();(0,rt.oL)(a,go.Z.ADD,this.addFeature_,this),(0,rt.oL)(a,go.Z.REMOVE,this.removeFeature_,this)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.addFeatureLayerAssociation_=function(e,t){this.featureLayerAssociation_[(0,mo.sq)(e)]=t},t.prototype.getFeatures=function(){return this.featureOverlay_.getSource().getFeaturesCollection()},t.prototype.getHitTolerance=function(){return this.hitTolerance_},t.prototype.getLayer=function(e){return this.featureLayerAssociation_[(0,mo.sq)(e)]},t.prototype.getOverlay=function(){return this.featureOverlay_},t.prototype.setHitTolerance=function(e){this.hitTolerance_=e},t.prototype.setMap=function(t){var o=this.getMap(),r=this.getFeatures();o&&r.forEach(o.unskipFeature.bind(o)),e.prototype.setMap.call(this,t),this.featureOverlay_.setMap(t),t&&r.forEach(t.skipFeature.bind(t))},t.prototype.addFeature_=function(e){var t=this.getMap();t&&t.skipFeature(e.element)},t.prototype.removeFeature_=function(e){var t=this.getMap();t&&t.unskipFeature(e.element)},t.prototype.removeFeatureLayerAssociation_=function(e){delete this.featureLayerAssociation_[(0,mo.sq)(e)]},t}(So.ZP);function Fo(e){if(!this.condition_(e))return!0;var t=this.addCondition_(e),o=this.removeCondition_(e),r=this.toggleCondition_(e),s=!t&&!o&&!r,i=e.map,n=this.getFeatures(),a=[],l=[];if(s){(0,Lo.ZH)(this.featureLayerAssociation_),i.forEachFeatureAtPixel(e.pixel,function(e,t){if(this.filter_(e,t))return l.push(e),this.addFeatureLayerAssociation_(e,t),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var p=n.getLength()-1;p>=0;--p){var h=n.item(p),c=l.indexOf(h);c>-1?l.splice(c,1):(n.remove(h),a.push(h))}0!==l.length&&n.extend(l)}else{i.forEachFeatureAtPixel(e.pixel,function(e,s){if(this.filter_(e,s))return!t&&!r||(0,po.q9)(n.getArray(),e)?(o||r)&&(0,po.q9)(n.getArray(),e)&&(a.push(e),this.removeFeatureLayerAssociation_(e)):(l.push(e),this.addFeatureLayerAssociation_(e,s)),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var u=a.length-1;u>=0;--u)n.remove(a[u]);n.extend(l)}return(l.length>0||a.length>0)&&this.dispatchEvent(new Po("select",l,a,e)),(0,it.MJ)(e)}const Oo=To;function Io(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}const Go=new Oe.Z;class Mo extends S().Component{constructor(){var e;super(...arguments),e=this,Io(this,"getNewFeature",((e,t,o,r)=>new qe.Z({geometry:this.createOLGeometry({type:e,coordinates:t,radius:o,center:r})}))),Io(this,"getMapCrs",(()=>this.props.map.getView().getProjection().getCode())),Io(this,"updateFeatureStyles",(e=>{e&&e.length>0&&e.forEach((e=>{if(e.style){let t=this.toOlFeature(e);t&&t.setStyle(e.style?(0,Le.C2)(e):this.toOlStyle(e.style,e.selected))}}))})),Io(this,"updateOnlyFeatureStyles",(e=>{this.drawLayer&&this.drawLayer.getSource().getFeatures().forEach((t=>{let o=Qt()(e.features).features||e.features,r=ee()(o,(e=>e.properties.id===t.getProperties().id));if(r){let e=(0,Fe.createStylesAsync)(Se()(r.style));be().all(e).then((e=>{t.setStyle((()=>(0,Le.Cw)({...r,style:e})))}))}}))})),Io(this,"addLayer",((e,t)=>{let o=null;const r=this.convertGeometryTypeToStyleType(e.drawMethod);o=t=>{let o=Qt()(e.features)&&ee()(Qt()(e.features).features,(e=>e.properties.id===t.getProperties().id))||null;if(o){let e=(0,Fe.createStylesAsync)(Se()(o.style));return be().all(e).then((e=>{t.setStyle((()=>(0,Le.Cw)({...o,style:e})))})),null}return(0,Le.Cw)({style:Le.jF[r]})},this.geojson=new Oe.Z,this.drawSource=new Ue.Z,this.drawLayer=new We.Z({source:this.drawSource,zIndex:1e8,style:o}),this.props.map.addLayer(this.drawLayer),t&&this.addInteractions(e);let s=Qt()(e.features);if(s&&s.features&&s.features.length){const t=s.features.filter((t=>!t.properties.isCircle||t.properties.isCircle&&!t.properties.canEdit||!e.options.drawEnabled));return this.addFeatures(P()({},e,{features:[{...s,features:t}]}))}return this.addFeatures(e)})),Io(this,"addFeatures",(e=>{let{features:t,drawMethod:o,options:r}=e;const s=this.getMapCrs();let i;if(t.forEach((e=>{if("FeatureCollection"===e.type){let t=(new Oe.Z).readFeatures(e);r.geodesic||(t=t.map((e=>Te(e,s)))),this.drawSource=new Ue.Z({features:t}),this.drawLayer.setSource(this.drawSource)}else{let n=null,a=e;var t;if(a.geometry&&"GeometryCollection"!==a.geometry.type&&(a=(0,T.reprojectGeoJson)(a,a.featureProjection,s).geometry),"GeometryCollection"!==a.type)"Circle"===o&&a&&(a.properties&&a.properties.center||a.center)?(n=a.properties&&a.properties.center?(0,T.reproject)(a.properties.center,"EPSG:4326",s):a.center,n=[n.x,n.y],i=new qe.Z({geometry:this.createOLGeometry({type:"Circle",center:n,projection:"EPSG:3857",radius:a.properties&&a.properties.radius||a.radius,options:r})})):i=new qe.Z({geometry:this.createOLGeometry(a.geometry?a.geometry:{...a,radius:null===(t=a.properties)||void 0===t?void 0:t.radius,center:n})}),i.setProperties(e.properties),this.drawSource.addFeature(i)}})),0===t.length&&(r.editEnabled||r.drawEnabled))r.transformToFeatureCollection?(this.drawSource=new Ue.Z({features:(new Oe.Z).readFeatures({type:"FeatureCollection",features:[]})}),this.drawLayer.setSource(this.drawSource)):(i=new qe.Z({geometry:this.createOLGeometry({type:o,coordinates:null})}),this.drawSource.addFeature(i));else{if(t[0]&&"GeometryCollection"===t[0].type){this.drawSource=new Ue.Z({features:(new Oe.Z).readFeatures(t[0])});let e=this.replacePolygonsWithCircles(this.drawSource.getFeatures()[0]);this.drawSource.getFeatures()[0].getGeometry().setGeometries(e),this.drawLayer.setSource(this.drawSource)}t[0]&&t[0].geometry&&"GeometryCollection"===t[0].geometry.type&&(i=(0,T.reprojectGeoJson)(t[0],r.featureProjection,s).geometry,this.drawSource=new Ue.Z({features:(new Oe.Z).readFeatures(i)}),this.drawSource.getFeatures()[0].set("textGeometriesIndexes",t[0].properties&&t[0].properties.textGeometriesIndexes),this.drawSource.getFeatures()[0].set("textValues",t[0].properties&&t[0].properties.textValues),this.drawSource.getFeatures()[0].set("circles",t[0].properties&&t[0].properties.circles),this.drawLayer.setSource(this.drawSource))}return this.updateFeatureStyles(t),i})),Io(this,"replaceFeatures",(e=>{let t;return this.drawLayer?(this.drawSource.clear(),t=this.addFeatures(e),e.style&&this.drawLayer.setStyle((t=>{let o=ee()(Qt()(e.features).features,(e=>e.properties.id===t.getProperties().id));if(o){let e=(0,Fe.createStylesAsync)(Se()(o.style));return be().all(e).then((e=>{t.setStyle((()=>(0,Le.Cw)({...o,style:e})))})),null}const r=this.convertGeometryTypeToStyleType(e.drawMethod);return(0,Le.Cw)({style:Le.jF[r]})}))):t=this.addLayer(e,e.options&&e.options.drawEnabled||!1),t})),Io(this,"endDrawing",(e=>{const t=this.replaceFeatures(e);if(t){const o=this.fromOLFeature(t);"Circle"===e.drawMethod&&e&&e.features&&e.features.length&&e.features[0]&&e.features[0].radius>=0&&(o.radius=e.features[0].radius),this.props.onEndDrawing(o,e.drawOwner)}})),Io(this,"addDrawInteraction",((e,t,o,r)=>{this.drawInteraction&&this.removeDrawInteraction(),this.drawInteraction=new ft(this.drawPropertiesForGeometryType(e,o,this.drawSource,r)),this.props.map.disableEventListener("singleclick"),this.drawInteraction.on("drawstart",(()=>{this.selectInteraction&&(this.selectInteraction.getFeatures().clear(),this.selectInteraction.setActive(!1))})),this.drawInteraction.on("drawend",(e=>{const o=e.feature.clone();if(o.set("id",io().v1()),"Circle"===this.props.drawMethod&&"Circle"===o.getGeometry().getType()){const e=o.getGeometry().getRadius(),t=o.getGeometry().getCenter();o.setGeometry(this.polygonFromCircle(t,e))}const r=this.fromOLFeature(o,t);this.props.onEndDrawing(r,this.props.drawOwner),this.props.options.stopAfterDrawing&&this.props.onChangeDrawingStatus("stop",this.props.drawMethod,this.props.drawOwner,this.props.features.concat([r])),this.selectInteraction&&(this.addSelectInteraction(),this.selectInteraction.setActive(!0))})),this.props.map.addInteraction(this.drawInteraction),this.setDoubleClickZoomEnabled(!1)})),Io(this,"toMulti",(e=>"Point"===e.getType()?new A.Z([e.getCoordinates()]):e)),Io(this,"handleDrawAndEdit",((e,t,o,r)=>{this.drawInteraction&&this.removeDrawInteraction(),this.drawInteraction=new ft(this.drawPropertiesForGeometryType((0,O.getSimpleGeomType)(e),o,(0,O.isSimpleGeomType)(e)?this.drawSource:null,r)),this.props.map.disableEventListener("singleclick"),this.drawInteraction.on("drawstart",(()=>{this.selectInteraction&&(this.selectInteraction.getFeatures().clear(),this.selectInteraction.setActive(!1))})),this.drawInteraction.on("drawend",(o=>{const s=o.feature.clone(),i=io().v1();s.set("id",i);let n,a,l,p=s.getGeometry(),h=this.drawLayer.getSource().getFeatures(),c=this.props.features;if(this.props.options.transformToFeatureCollection){let t;if("Circle"===e){let e,s,n;if(l="Polygon",this.props.options.geodesic){s=o.feature.getGeometry().geodesicCenter||(0,w.qg)(p.getExtent());const t=this.props.map.getView().getProjection().getCode(),r=[[...s],[...p.getCoordinates()[0][0]]].map((e=>this.reprojectCoordinatesToWGS84(e,t)));e=(0,T.calculateDistance)(r,"haversine"),n=(0,K.iu)(r[0],e).clone().transform("EPSG:4326",t).getCoordinates()}else e=p.getRadius(),s=p.getCenter(),n=this.polygonCoordsFromCircle(s,e);t=this.getNewFeature(l,n),s=(0,T.reproject)(s,this.getMapCrs(),"EPSG:4326",!1);const a=r&&r.features&&r.features.length&&r.features[0]&&r.features[0].features&&r.features[0].features.length&&r.features[0].features.filter((e=>e.properties.isDrawing))[0].properties.id||i;t.setProperties({isCircle:!0,radius:e,center:[s.x,s.y],id:a,crs:this.getMapCrs(),isGeodesic:this.props.options.geodesic})}else if("Polygon"===e){l=this.props.drawMethod;let e=p.getCoordinates();e[0].push(e[0][0]),t=this.getNewFeature(l,e)}else{l="Text"===e?"Point":this.props.drawMethod;let o=p.getCoordinates();t=this.getNewFeature(l,o),"Text"===e&&t.setProperties({isText:!0,valueText:"."})}const s=h.length>=1?[...this.replaceCirclesWithPolygonsInFeatureColl(h)]:[];t.getProperties().id||t.setProperties({id:io().v1()});const n=[...s,t];let a=Go.writeFeaturesObject(n);const c=new Ue.Z({features:(new Oe.Z).readFeatures(a)});this.drawLayer.setSource(c);let u=(0,T.reprojectGeoJson)(a,this.getMapCrs(),"EPSG:4326");this.props.onGeometryChanged([u],this.props.drawOwner,this.props.options&&this.props.options.stopAfterDrawing?"enterEditMode":"","Text"===e,"Circle"===e),this.props.onEndDrawing(u,this.props.drawOwner),this.props.onDrawingFeatures([Ae()(u.features)])}else{if("Circle"===e){l="Polygon";const e=p.getRadius(),t=p.getCenter(),o=this.polygonCoordsFromCircle(t,e),r=this.toMulti(this.createOLGeometry({type:l,coordinates:o}));if(1===c.length&&c[0]&&!c[0].geometry)n=[],a=new ao.default([r]);else if(n=this.toMulti(Qt()(h).getGeometry()),n.getGeometries){const e=this.replaceCirclesWithPolygons(Qt()(h));a=new ao.default([...e,r])}else a=new ao.default([n,r]);s.setGeometry(a)}else if("Text"===e||"MultiPoint"===e){let e=p.getCoordinates();l="MultiPoint";let t=this.toMulti(this.createOLGeometry({type:l,coordinates:[e]}));if(1!==c.length||c[0].geometry)if(n=this.toMulti(Qt()(h).getGeometry()),n.getGeometries){let e=this.replaceCirclesWithPolygons(Qt()(h));a=new ao.default([...e,t])}else a=n.clone(),a.appendPoint(t.getPoint(0));else n=[],a=t.clone();s.setGeometry(a)}else if(!(0,O.isSimpleGeomType)(e)){let t;a=null,n=1!==c.length||c[0].geometry?this.toMulti(Qt()(h).getGeometry()):this.toMulti(this.createOLGeometry({type:e,coordinates:null}));let o=h.map((e=>"GeometryCollection"===e.getGeometry().getType()?e.getGeometry().getGeometries():e.getGeometry()));"GeometryCollection"===h[0].getGeometry().getType()&&(o=o[0]);let r=ee()(o,(t=>t.getType()===e));if(r?this.appendToMultiGeometry(e,r,p):t=this.toMulti(this.createOLGeometry({type:e,coordinates:p.getCoordinates()})),p.getType()!==(0,O.getSimpleGeomType)(n.getType())){let o=Qt()(h).getGeometry().getGeometries?this.replaceCirclesWithPolygons(Qt()(h)):[];if(r){let e=o.map((e=>e.getType()===r.getType()?r:e));a=new ao.default(e)}else a="GeometryCollection"===n.getType()?new ao.default([...o,t]):"Text"===e?new ao.default([t]):new ao.default([n,t]);s.setGeometry(a)}else s.setGeometry(r)}let o=this.props.features[0].properties;"Text"===e&&(o=P()({},this.props.features[0].properties,{textValues:(this.props.features[0].properties.textValues||[]).concat(["."]),textGeometriesIndexes:(this.props.features[0].properties.textGeometriesIndexes||[]).concat([s.getGeometry().getGeometries().length-1])})),"Circle"===e&&(o=P()({},o,{circles:(this.props.features[0].properties.circles||[]).concat([s.getGeometry().getGeometries().length-1])}));let r=this.fromOLFeature(s,t,o);const i=new Ue.Z({features:(new Oe.Z).readFeatures(r)});this.drawLayer.setSource(i);let u=(0,T.reprojectGeoJson)(Go.writeFeatureObject(s.clone()),this.getMapCrs(),"EPSG:4326");"Polygon"===u.geometry.type&&u.geometry.coordinates[0].push(u.geometry.coordinates[0][0]),this.props.onGeometryChanged([u],this.props.drawOwner,this.props.options&&this.props.options.stopAfterDrawing?"enterEditMode":"","Text"===e,"Circle"===e),this.props.onEndDrawing(r,this.props.drawOwner),r=(0,T.reprojectGeoJson)(r,this.getMapCrs(),"EPSG:4326");const d=(0,O.isSimpleGeomType)(this.props.drawMethod)&&"GeometryCollection"!==this.props.features[0].geometry.type?this.props.features.map((e=>({...e,featureProjection:this.getMapCrs()}))).concat([{...r,type:"Feature",geometry:{type:r.type,coordinates:r.coordinates},featureProjection:this.getMapCrs(),properties:o}]):[{...r,properties:o}];this.props.options.stopAfterDrawing?this.props.onChangeDrawingStatus("stop",this.props.drawMethod,this.props.drawOwner,d):this.props.onChangeDrawingStatus("replace",this.props.drawMethod,this.props.drawOwner,d.map((e=>(0,T.reprojectGeoJson)(e,"EPSG:4326",this.getMapCrs()))),P()({},this.props.options,{featureProjection:this.getMapCrs()})),this.selectInteraction&&(this.addSelectInteraction(),this.selectInteraction.setActive(!0))}})),this.props.map.addInteraction(this.drawInteraction),this.setDoubleClickZoomEnabled(!1)})),Io(this,"drawPropertiesForGeometryType",(function(t,o,r){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i={source:e.drawSource||r,type:t,style:"Marker"===t?(0,Le.Fc)(s.style):new Ke.default({fill:new Xe.default({color:"rgba(255, 255, 255, 0.2)"}),stroke:new Ye.default({color:"rgba(0, 0, 0, 0.5)",lineDash:[10,10],width:2}),image:new $e.default({radius:5,stroke:new Ye.default({color:"rgba(0, 0, 0, 0.7)"}),fill:new Xe.default({color:"rgba(255, 255, 255, 0.2)"})})}),features:new St.Z,condition:it.Bx},n={};switch(t){case"BBOX":n.type="LineString",n.maxPoints=2,n.geometryFunction=function(e,t){let o=t;o||(o=new K.ZP([]));let r=e[0],s=e[1];return o.setCoordinates([[r,[r[0],s[1]],s,[s[0],r[1]],r]]),o};break;case"Circle":n.maxPoints=100,s.options&&s.options.geodesic?n.geometryFunction=(t,o)=>{let r=o;r||(r=new K.ZP([]),r.setProperties({geodesicCenter:[...t[0]]},!0));let s=e.props.map.getView().getProjection().getCode(),i=[...t].map((t=>e.reprojectCoordinatesToWGS84(t,s))),n=(0,T.calculateDistance)(i,"haversine"),a=(0,K.iu)(i[0],n).clone().transform("EPSG:4326",s).getCoordinates();return r.setCoordinates(a),r}:n.type=t;break;case"Marker":case"Point":case"Text":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":{"LineString"===t&&(n.maxPoints=o);let r="Text"===t||"Marker"===t?"Point":t;n.type=r,n.geometryFunction=(t,o)=>{let i=o;return i||(i=e.createOLGeometry({type:r,coordinates:null,options:s.options})),i.setCoordinates(t),i};break}default:return{}}return P()({},i,n)})),Io(this,"setDoubleClickZoomEnabled",(e=>{let t=this.props.map.getInteractions();for(let o=0;o<t.getLength();o++){let r=t.item(o);if(r instanceof G.Z){r.setActive(e);break}}})),Io(this,"updateFeatureExtent",(e=>{const t=e.features.getArray(),o=this.props.features.map((e=>{const o=Qt()(t.filter((t=>this.fromOLFeature(t).id===e.id)));return o?P()({},e,{geometry:o.geometry,center:o.center,extent:o.extent,coordinate:o.coordinates,radius:o.radius}):e}));this.props.onChangeDrawingStatus("replace",this.props.drawMethod,this.props.drawOwner,o)})),Io(this,"addInteractions",(e=>{this.clean(),this.drawLayer||this.addLayer(e),this.addDrawInteraction(e.drawMethod,e.options.startingPoint,e.options.maxPoints,e),e.options&&e.options.editEnabled&&(this.addSelectInteraction(),this.translateInteraction&&this.props.map.removeInteraction(this.translateInteraction),this.translateInteraction=new uo({features:this.selectInteraction.getFeatures()}),this.translateInteraction.setActive(!1),this.translateInteraction.on("translateend",this.updateFeatureExtent),this.props.map.addInteraction(this.translateInteraction),this.addTranslateListener(),this.modifyInteraction&&this.props.map.removeInteraction(this.modifyInteraction),this.modifyInteraction=new Eo({features:this.selectInteraction.getFeatures(),condition:e=>(0,it.Xp)(e)&&!(0,it.Ko)(e)}),this.props.map.addInteraction(this.modifyInteraction)),this.drawSource.clear(),e.features.length>0&&this.addFeatures(e)})),Io(this,"addSingleClickListener",((e,t)=>t.map.on("singleclick",e))),Io(this,"addDrawOrEditInteractions",(e=>{this.state&&this.state.keySingleClickCallback&&(0,vt.B)(this.state.keySingleClickCallback);this.clean();let t,o=e.features.map((t=>(0,T.reprojectGeoJson)(t,e.options.featureProjection,this.getMapCrs())||{}));const r=o.every((e=>!!(e&&e.features&&e.features.length))),s=o.every((e=>!!(e&&e.properties&&e.properties.isCircle)));if(r)t=P()({},e,{features:o});else if(s)t=P()({},e,{features:[]});else{const r=o.reduce(((e,t)=>t.geometry?[...e,{...t.geometry,properties:t.properties}]:e),[]);t=P()({},e,{features:r})}this.drawLayer?(this.drawSource.clear(),this.addFeatures(t)):this.addLayer(t),e.options.editEnabled&&(!e.options.geodesic&&this.addModifyInteraction(e),!1!==e.options.translateEnabled&&this.addTranslateInteraction(),e.options.addClickCallback&&this.setState({keySingleClickCallback:this.addSingleClickListener((t=>{if(this.drawSource&&e.options){let o=this.drawSource.getFeatures(),r=0;const s=o&&o.length&&o.filter(((e,t)=>(e.getProperties().canEdit&&(r=t),e.getProperties().canEdit)))[0]||null,i=s&&s.getGeometry()&&s.getGeometry().getCoordinates&&s.getGeometry().getCoordinates()||[];let n,l=[],p=e.drawMethod;switch(p){case"Polygon":i.length?(0,no.F7)(i)?(l=to()(i[0],0,i[0].length-1),l=l.concat([t.coordinate]),l=[l.concat([i[0][0]])]):l=i[0].length>1?[[...i[0],t.coordinate,i[0][0]]]:[[...i[0],t.coordinate]]:l=[[t.coordinate]],n=this.getNewFeature(p,l),n.setProperties(a()(s&&s.getProperties()||{},"geometry"));break;case"LineString":case"MultiPoint":l=i.length?[...i,t.coordinate]:[t.coordinate],n=this.getNewFeature(p,l),n.setProperties(a()(s&&s.getProperties()||{},"geometry"));break;case"Circle":{p="Polygon";const o=s&&s.getProperties()&&s.getProperties().radius||1e4;let r=t.coordinate,i=this.polygonCoordsFromCircle(r,o);if(e.options.geodesic){const e=this.props.map.getView().getProjection().getCode(),t=[[...r]].map((t=>this.reprojectCoordinatesToWGS84(t,e)));i=(0,K.iu)(t[0],o).clone().transform("EPSG:4326",e).getCoordinates()}n=this.getNewFeature(p,i),r=(0,T.reproject)(r,this.getMapCrs(),"EPSG:4326",!1),n.setProperties(a()(s&&s.getProperties()||{},"geometry")),n.setProperties({isCircle:!0,radius:o,center:[r.x,r.y],isGeodesic:this.props.options.geodesic});break}case"Text":p="Point",n=this.getNewFeature(p,t.coordinate),n.setProperties(a()(s&&s.getProperties()||{},"geometry")),n.setProperties({isText:!0,valueText:s&&s.getProperties()&&s.getProperties().valueText||e.options.defaultTextAnnotation||"New"});break;default:l=t.coordinate,n=this.getNewFeature(p,l),n.setProperties(a()(s&&s.getProperties()||{},"geometry"))}let h={type:"Feature",geometry:{coordinates:[...(0,T.reprojectGeoJson)(Go.writeFeaturesObject([n.clone()]),this.getMapCrs(),"EPSG:4326").features[0].geometry.coordinates],type:p},properties:{...a()(n.getProperties(),"geometry")}};this.props.onDrawingFeatures([h]),e.options.geodesic||(n=Te(n,this.getMapCrs())),o[r]=n,this.drawSource=new Ue.Z({features:o}),this.drawLayer.setSource(this.drawSource),this.addModifyInteraction(e)}}),e)})),e.options&&e.options.selectEnabled&&this.addSelectInteraction(e.options&&e.options.selected,e),e.options.drawEnabled&&this.handleDrawAndEdit(e.drawMethod,e.options.startingPoint,e.options.maxPoints,e)})),Io(this,"addSelectInteraction",((e,t)=>{let o;if(this.selectInteraction&&this.props.map.removeInteraction(this.selectInteraction),e&&(o=ee()(this.drawSource.getFeatures(),(t=>t.getProperties().id===e.properties.id)),o&&this.selectFeature(o)),this.selectInteraction=new Oo({layers:[this.drawLayer],features:new St.Z(e&&o?[o]:null)}),o){const e=this.convertGeometryTypeToStyleType(t.drawMethod);o.setStyle((0,Le.C2)({...t,style:{...t.style,type:e,highlight:!0,useSelectedStyle:t.options.useSelectedStyle}},!1,t.features[0]&&t.features[0].properties&&t.features[0].properties.valueText&&[t.features[0].properties.valueText]||[]))}this.selectInteraction.on("select",(e=>{let t=this.selectInteraction.getFeatures().getArray(),o=[];return t.length&&(o=this.props.features.map((o=>{let r=!1;if("FeatureCollection"===o.type&&t.length>0){let e=Qt()(t);if(this.selectFeature(e),e.getGeometry&&"Circle"===e.getGeometry().getType()){let t=e.getGeometry().getRadius(),o=(0,T.reproject)(e.getGeometry().getCenter(),this.getMapCrs(),"EPSG:4326");e.setProperties({center:[o.x,o.y],radius:t}),e=this.replaceCircleWithPolygon(e.clone())}return this.drawSource.getFeatures().forEach((t=>{t.getProperties().id===e.getProperties().id?this.selectFeature(e):this.deselectFeature(t)})),(0,T.reprojectGeoJson)(Go.writeFeatureObject(e.clone()),this.getMapCrs(),"EPSG:4326")}return r=t.reduce(((e,t)=>t.get("id")===o.id||e),!1),P()({},o,{selected:r,selectedFeature:e.selected})})),this.props.onSelectFeatures(o)),0===t.length?(this.props.onSelectFeatures([]),this.drawSource.getFeatures().map((e=>this.deselectFeature(e))),null):null})),this.props.map.addInteraction(this.selectInteraction)})),Io(this,"selectFeature",(e=>{e.setProperties({selected:!0})})),Io(this,"deselectFeature",(e=>{e.setProperties({selected:!1})})),Io(this,"removeDrawInteraction",(()=>{this.drawInteraction&&(this.props.map.removeInteraction(this.drawInteraction),this.drawInteraction=null,setTimeout((()=>this.props.map.enableEventListener("singleclick")),500),setTimeout((()=>this.setDoubleClickZoomEnabled(!0)),250))})),Io(this,"removeInteractions",(()=>{this.removeDrawInteraction(),this.selectInteraction&&(this.props.map.enableEventListener("singleclick"),this.props.map.removeInteraction(this.selectInteraction)),this.modifyInteraction&&(this.props.map.removeInteraction(this.modifyInteraction),this.props.map.un("singleclick")),this.translateInteraction&&this.props.map.removeInteraction(this.translateInteraction)})),Io(this,"clean",(e=>{e||this.removeInteractions(),this.drawLayer&&(this.props.map.removeLayer(this.drawLayer),this.geojson=null,this.drawLayer=null,this.drawSource=null)})),Io(this,"fromOLFeature",((e,t,o)=>{const r=e.getGeometry(),s=this.props.map.getView().getProjection().getCode(),i=r.getType();if(r.getCoordinates){const o=r.getExtent(),n=r.getProperties(),a=n&&n.geodesicCenter||(0,w.qg)(o);let l,p=r.getCoordinates();if(t&&(p=$t()(t,p),r.setCoordinates(p)),"Circle"===this.props.drawMethod)if(this.props.options.geodesic){const e=[[...a],[...p[0][0]]].map((e=>this.reprojectCoordinatesToWGS84(e,s)));l=(0,T.calculateDistance)(e,"haversine")}else l=this.calculateRadius(a,p);return P()({},{id:e.get("id"),type:i,extent:o,center:a,coordinates:p,radius:l,style:this.fromOlStyle(e.getStyle()),projection:this.getMapCrs()})}let n=r.getGeometries().map(((r,i)=>{const n=r.getExtent(),a=(0,w.qg)(n);let l,p=r.getCoordinates();if(t&&(p=$t()(t,p),r.setCoordinates(p)),o.circles&&-1!==o.circles.indexOf(i))if(this.props.options.geodesic){const e=[[...a],[...p[0][0]]].map((e=>this.reprojectCoordinatesToWGS84(e,s)));l=(0,T.calculateDistance)(e,"haversine")}else l=this.calculateRadius(a,p);else l=0;return P()({},{id:e.get("id"),type:r.getType(),extent:n,center:a,coordinates:p,radius:l,style:this.fromOlStyle(e.getStyle()),projection:this.getMapCrs()})}));return P()({},{type:"Feature",id:e.get("id"),style:this.fromOlStyle(e.getStyle()),geometry:{type:"GeometryCollection",geometries:n},projection:s})})),Io(this,"reprojectCoordinatesToWGS84",((e,t)=>{let o=(0,T.reproject)(e,t,"EPSG:4326");return[o.x,o.y]})),Io(this,"toOlFeature",(e=>Qt()(this.drawSource.getFeatures().filter((t=>t.get("id")===e.id))))),Io(this,"fromOlStyle",(e=>e?{fillColor:this.rgbToHex(e.getFill().getColor()),fillTransparency:e.getFill().getColor()[3],strokeColor:e.getStroke().getColor(),strokeWidth:e.getStroke().getWidth(),text:e.getText().getText()}:{})),Io(this,"toOlStyle",((e,t,o)=>{let r=e&&e.fillColor?e.fillColor:[255,255,255,.2];"string"==typeof r&&(r=this.hexToRgb(r).concat([e.fillOpacity>=0&&e.fillOpacity<=1?e.fillOpacity:1])),e&&e.fillTransparency&&(r[3]=e.fillTransparency);let s=e&&(e.strokeColor||e.color)?e.strokeColor||e.color:"#ffcc33";t&&(s="#4a90e2"),s=this.hexToRgb(s).concat([e&&e.opacity||1]);let i=new Ke.default({fill:new Xe.default({color:r}),stroke:new Ye.default({color:s,width:e&&(e.strokeWidth||e.weight)?e.strokeWidth||e.weight:2}),text:new lo.default({text:e&&e.text?e.text:"",fill:new Xe.default({color:e&&(e.strokeColor||e.color)?e.strokeColor||e.color:"#000"}),stroke:new Ye.default({color:"#fff",width:2}),font:e&&e.fontSize?e.fontSize+"px helvetica":""})});return"GeometryCollection"===o?[...(0,Le.EC)({style:{iconGlyph:"comment",iconShape:"square",iconColor:"blue"}}),i]:e&&(e.iconUrl||e.iconGlyph)?(0,Le.EC)({style:e}):i})),Io(this,"hexToRgb",(e=>{const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,o,r){return t+t+o+o+r+r})));return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:null})),Io(this,"componentToHex",(e=>{var t=e.toString(16);return 1===t.length?"0"+t:t})),Io(this,"rgbToHex",(e=>"#"+this.componentToHex(e[0])+this.componentToHex(e[1])+this.componentToHex(e[2]))),Io(this,"addModifyInteraction",(e=>{this.modifyInteraction&&this.props.map.removeInteraction(this.modifyInteraction);const t=e&&e.options&&e.options.editFilter;this.modifyFeatureColl=new St.Z(ro()(this.drawLayer.getSource().getFeatures(),t)),this.modifyInteraction=new Eo({features:this.modifyFeatureColl,condition:e=>(0,it.Xp)(e)&&!(0,it.Ko)(e)}),this.modifyInteraction.on("modifyend",(e=>{let t=e.features.getArray().map((e=>{let t=e.clone();if(t.getGeometry&&"GeometryCollection"===t.getGeometry().getType()&&t.getGeometry().setGeometries(this.replaceCirclesWithPolygons(t)),t.getGeometry&&t.getGeometry()&&"Circle"===t.getGeometry().getType()){let o=(0,T.reproject)(t.getGeometry().getCenter(),this.getMapCrs(),"EPSG:4326"),r=t.getGeometry().getRadius();t.setProperties({center:[o.x,o.y],radius:r}),e.setProperties({center:[o.x,o.y],radius:r}),t=this.replaceCircleWithPolygon(t.clone())}return(0,T.reprojectGeoJson)(Go.writeFeatureObject(t),this.getMapCrs(),"EPSG:4326")}));this.props.options.transformToFeatureCollection?this.props.onDrawingFeatures(t):this.props.onGeometryChanged(t,this.props.drawOwner,!1,"editing","editing")})),this.props.map.addInteraction(this.modifyInteraction)})),Io(this,"addTranslateInteraction",(()=>{this.translateInteraction&&this.props.map.removeInteraction(this.translateInteraction),this.translateInteraction=new uo({features:new St.Z(this.drawLayer.getSource().getFeatures())}),this.translateInteraction.setActive(!1),this.translateInteraction.on("translateend",(e=>{let t=e.features.getArray().map((e=>{let t=e.clone();if(t.getGeometry&&"GeometryCollection"===t.getGeometry().getType()&&t.getGeometry().setGeometries(this.replaceCirclesWithPolygons(t)),t.getGeometry&&t.getGeometry()&&"Circle"===t.getGeometry().getType()){let e=(0,T.reproject)(t.getGeometry().getCenter(),this.getMapCrs(),"EPSG:4326"),o=t.getGeometry().getRadius();t.setProperties({center:[e.x,e.y],radius:o}),t=this.replaceCircleWithPolygon(t)}return e.getProperties()&&e.getProperties().selected&&this.props.onSelectFeatures([(0,T.reprojectGeoJson)(Go.writeFeatureObject(t),this.getMapCrs(),"EPSG:4326")]),(0,T.reprojectGeoJson)(Go.writeFeatureObject(t),this.getMapCrs(),"EPSG:4326")}));this.props.options.transformToFeatureCollection?this.props.onDrawingFeatures(t):this.props.onGeometryChanged(t,this.props.drawOwner,this.props.drawOwner,!1,"Text"===this.props.drawMethod,"Circle"===this.props.drawMethod)})),this.addTranslateListener(),this.props.map.addInteraction(this.translateInteraction)})),Io(this,"createOLGeometry",(e=>{let{type:t,coordinates:o,radius:r,center:s,geometries:i,projection:n,options:a={}}=e;return"GeometryCollection"===t?i&&i.length?new ao.default(i.map((e=>this.olGeomFromType({type:e.type})))):new ao.default([]):this.olGeomFromType({type:t,coordinates:o,radius:r,center:s,projection:n,options:a})})),Io(this,"olGeomFromType",(e=>{let t,{type:o,coordinates:r,radius:s,center:i,projection:n,options:a}=e;switch(o){case"Point":case"Marker":case"Text":t=new R.Z(r||[]);break;case"LineString":t=new N.Z(r||[]);break;case"MultiPoint":t=new A.Z(r||[]);break;case"MultiLineString":t=new V.Z(r||[]);break;case"MultiPolygon":t=new z.Z(r||[]);break;default:{let e=se()(i)?{x:i[0],y:i[1]}:i;const o=n&&!isNaN(parseFloat(s))&&e&&!ne()(e.x)&&!ne()(e.y)&&!isNaN(parseFloat(e.x))&&!isNaN(parseFloat(e.y));t=o?a.geodesic?(0,K.iu)(this.reprojectCoordinatesToWGS84([e.x,e.y],n),s,100).clone().transform("EPSG:4326",n):(0,K.Bb)(new q([e.x,e.y],s),100):new K.ZP(r&&se()(r[0])?r:[]),t&&o&&a.geodesic&&t.setProperties({geodesicCenter:[e.x,e.y]},!0)}}return t})),Io(this,"convertGeometryTypeToStyleType",(e=>"BBOX"===e?"LineString":e)),Io(this,"appendToMultiGeometry",((e,t,o)=>{switch(e){case"MultiPoint":t.appendPoint(o);break;case"MultiLineString":t.appendLineString(o);break;case"MultiPolygon":{let e=o.getCoordinates();e[0].push(e[0][0]),o.setCoordinates(e),t.appendPolygon(o);break}}})),Io(this,"calculateRadius",((e,t)=>se()(t)&&se()(t[0])&&se()(t[0][0])?Math.sqrt(Math.pow(e[0]-t[0][0][0],2)+Math.pow(e[1]-t[0][0][1],2)):100)),Io(this,"polygonFromCircle",(function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;return(0,K.Bb)(new q(e,t),o)})),Io(this,"polygonCoordsFromCircle",(function(t,o){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;return e.polygonFromCircle(t,o,r).getCoordinates()})),Io(this,"replaceCirclesWithPolygonsInFeatureColl",(e=>e.map((e=>"Circle"!==e.getGeometry().getType()?e:this.replaceCircleWithPolygon(e))))),Io(this,"replaceCircleWithPolygon",(e=>{if(e.getProperties().isCircle&&"Circle"===e.getGeometry().getType()){const t=e.getGeometry().getCenter(),o=e.getGeometry().getRadius();return e.setGeometry(this.polygonFromCircle(t,o)),e}return e})),Io(this,"replaceCirclesWithPolygons",(e=>e.getGeometry&&!e.getGeometry().getGeometries?e:e.getGeometry().getGeometries().map(((t,o)=>{if("Circle"!==t.getType())return t;if(e.getProperties()&&e.getProperties().circles&&-1!==e.getProperties().circles.indexOf(o)){const e=t.getCenter(),o=t.getRadius();return this.polygonFromCircle(e,o)}return t})))),Io(this,"replacePolygonsWithCircles",(e=>e.getGeometry().getGeometries().map(((t,o)=>{if("Polygon"!==t.getType())return t;if(e.getProperties()&&e.getProperties().circles&&-1!==e.getProperties().circles.indexOf(o)){const e=t.getExtent(),o=(0,w.qg)(e),r=this.calculateRadius(o,t.getCoordinates());return new q(o,r)}return t})))),Io(this,"addTranslateListener",(()=>{document.addEventListener("keydown",(e=>{e.altKey&&"AltLeft"===e.code&&this.translateInteraction.setActive(!0)})),document.addEventListener("keyup",(e=>{"AltLeft"===e.code&&this.translateInteraction.setActive(!1)}))}))}UNSAFE_componentWillReceiveProps(e){if(this.drawLayer&&this.updateFeatureStyles(e.features),!e.drawStatus&&this.selectInteraction&&this.selectInteraction.getFeatures().clear(),this.props.drawStatus!==e.drawStatus||this.props.drawMethod!==e.drawMethod||this.props.features!==e.features)switch(e.drawStatus){case"create":this.addLayer(e);break;case"start":this.addInteractions(e);break;case"drawOrEdit":this.addDrawOrEditInteractions(e);break;case"stop":this.removeDrawInteraction();break;case"replace":this.replaceFeatures(e);break;case"updateStyle":this.updateOnlyFeatureStyles(e);break;case"clean":this.clean();break;case"cleanAndContinueDrawing":this.clean(!0);break;case"endDrawing":this.endDrawing(e);break;default:return}}render(){return null}}function ko(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}Io(Mo,"propTypes",{map:i().object,drawOwner:i().string,drawStatus:i().string,drawMethod:i().string,options:i().object,features:i().array,onChangeDrawingStatus:i().func,onGeometryChanged:i().func,onDrawStopped:i().func,onDrawingFeatures:i().func,onSelectFeatures:i().func,onEndDrawing:i().func,style:i().object}),Io(Mo,"defaultProps",{map:null,drawOwner:null,drawStatus:null,drawMethod:null,features:null,options:{stopAfterDrawing:!0},onChangeDrawingStatus:()=>{},onGeometryChanged:()=>{},onDrawStopped:()=>{},onDrawingFeatures:()=>{},onSelectFeatures:()=>{},onEndDrawing:()=>{}});class jo extends S().Component{constructor(){super(...arguments),ko(this,"getLayer",(()=>{let e;return this.props.map.getLayers().forEach((t=>{this.layersFilter(t)&&(e=t)}),this),e})),ko(this,"setSelectInteraction",(()=>{this._selectInteraction.getActive()||this._selectInteraction.setActive(!0)})),ko(this,"createSelectInteraction",(()=>{this.createStyle(),this._selectInteraction=new Oo({layers:this.layersFilter,style:this._style,toggleCondition:it.QC}),this._selectInteraction.on("select",this.selectionChange,this),this.props.map.addInteraction(this._selectInteraction)})),ko(this,"selectionChange",(()=>{let e=[];this._selectInteraction.getFeatures().forEach((t=>{e.push(t.getId())})),this.props.updateHighlighted(e,"")})),ko(this,"cleanSupport",(()=>{this._selectInteraction&&this._selectInteraction.getActive()&&(this._selectInteraction.getFeatures().clear(),this.props.updateHighlighted([],""),this._selectInteraction.setActive(!1))})),ko(this,"layersFilter",(e=>this.props.layer&&e.get("msId")===this.props.layer)),ko(this,"createStyle",(()=>{let e=this.props.selectedStyle,t={stroke:new Ye.default(e.stroke?e.stroke:{color:"blue",width:1}),fill:new Xe.default(e.fill?e.fill:{color:"blue"})};"Point"===e.type&&(t={image:new $e.default({...t,radius:e.radius||5})}),this._style=new Ke.default(t)})),ko(this,"highlightFeatures",(e=>{let t=this.getLayer(),o=this._selectInteraction.getFeatures();o.clear(),t&&t.getSource().getFeatures().map((t=>{-1!==e.indexOf(t.getId())&&o.push(t)}),this)}))}componentDidMount(){this.createSelectInteraction(),"enabled"===this.props.status?this._selectInteraction.setActive(!0):this._selectInteraction.setActive(!1),this.props.features&&this.highlightFeatures(this.props.features)}shouldComponentUpdate(e){let t=this.props;return e.status!==t.status||e.layer!==t.layer||"update"===e.status&&e.features.toString()!==t.features.toString()}UNSAFE_componentWillUpdate(e){switch(e.status){case"enabled":this.setSelectInteraction(e);break;case"disabled":this.cleanSupport();break;case"update":this.highlightFeatures(e.features);break;default:return}}componentWillUnmount(){this._selectInteraction&&(this.cleanSupport(),this._selectInteraction.un("select",this.selectionChange,this),this.props.map.removeInteraction(this._selectInteraction),this._selectInteraction=null,this._style=null)}render(){return null}}function Zo(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}ko(jo,"propTypes",{map:i().object,layer:i().string.isRequired,status:i().oneOf(["disabled","enabled","update"]),updateHighlighted:i().func,selectedStyle:i().object,features:i().array}),ko(jo,"contextTypes",{messages:i().object}),ko(jo,"defaultProps",{status:"disabled",updateHighlighted:()=>{},selectedStyle:{type:"Point",radius:12,stroke:{width:4,color:"yellow"},fill:{color:"red"}}});class Do extends S().Component{constructor(){super(...arguments),Zo(this,"addDrawInteraction",(e=>{this.drawInteraction&&this.removeDrawInteraction();let t=new Ue.Z,o=new We.Z({source:t,zIndex:1e6,style:new Ke.default({fill:new Xe.default({color:"rgba(255, 255, 255, 0.2)"}),stroke:new Ye.default({color:"#ffcc33",width:2}),image:new $e.default({radius:7,fill:new Xe.default({color:"#ffcc33"})})})});this.props.map.addLayer(o);let r=new ft({source:t,type:e.selection.geomType,style:new Ke.default({fill:new Xe.default({color:"rgba(255, 255, 255, 0.2)"}),stroke:new Ye.default({color:"rgba(0, 0, 0, 0.5)",lineDash:[10,10],width:2}),image:new $e.default({radius:5,stroke:new Ye.default({color:"rgba(0, 0, 0, 0.7)"}),fill:new Xe.default({color:"rgba(255, 255, 255, 0.2)"})})})});r.on("drawstart",(e=>{this.sketchFeature=e.feature,t.clear()})),r.on("drawend",(()=>{this.updateSelectionState()})),this.props.map.addInteraction(r),this.drawInteraction=r,this.selectionLayer=o,this.setDoubleClickZoomEnabled(!1)})),Zo(this,"removeDrawInteraction",(()=>{null!==this.drawInteraction&&(this.props.map.removeInteraction(this.drawInteraction),this.drawInteraction=null,this.props.map.removeLayer(this.selectionLayer),this.sketchFeature=null,setTimeout((()=>this.setDoubleClickZoomEnabled(!0)),251))})),Zo(this,"updateSelectionState",(()=>{if(!this.sketchFeature)return;const e=this.sketchFeature.getGeometry().getCoordinates();let t={geomType:this.props.selection.geomType,point:"Point"===this.props.selection.geomType?[e[0],e[1]]:null,line:"LineString"===this.props.selection.geomType?e.map((e=>[e[0],e[1]])):null,polygon:"Polygon"===this.props.selection.geomType?this.sketchFeature.getGeometry().getLinearRing(0).getCoordinates().map((e=>[e[0],e[1]])):null};this.props.changeSelectionState(t)})),Zo(this,"setDoubleClickZoomEnabled",(e=>{let t=this.props.map.getInteractions();for(let o=0;o<t.getLength();o++){let r=t.item(o);if(r instanceof G.Z){r.setActive(e);break}}}))}UNSAFE_componentWillReceiveProps(e){e.selection.geomType&&e.selection.geomType!==this.props.selection.geomType&&this.addDrawInteraction(e),e.selection.geomType||this.removeDrawInteraction()}render(){return null}}Zo(Do,"propTypes",{map:i().object,projection:i().string,selection:i().object,changeSelectionState:i().func}),Zo(Do,"defaultProps",{selection:{}});var Ro=o(73935),No=o.n(Ro),Ao=o(47037),Vo=o.n(Ao),zo=o(26160),Bo=o(84081);function Ho(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class Uo extends S().Component{constructor(){super(...arguments),Ho(this,"onPopupClose",(e=>{this.props.onPopupClose(e)})),Ho(this,"renderPopups",(()=>this.preparePopups().map((e=>{let{popup:t,id:o,component:r,content:s,props:i,containerStyle:n}=e;const a=t.getElement(),l=Vo()(r)&&Bo.Z[r]||r;let p;return l?p=S().isValidElement(l)&&l||S().createElement(l,i):s&&(p=zo.FP(s)?S().createElement("div",{dangerouslySetInnerHTML:{__html:s}}):s),a&&No().createPortal(S().createElement("div",{className:"map-popup-ol",key:o,onMouseUp:this.convertToClick},S().createElement("div",{className:"ol-popup-content-wrapper"},S().createElement("div",{className:"ol-popup-content",style:n},p)),S().createElement("div",{className:"ol-popup-closer",onClick:()=>this.onPopupClose(o)},"x")),a)})))),Ho(this,"update",(()=>{(this._popups||[]).map((e=>{let{popup:t}=e;t.setElement(t.getElement())}))})),Ho(this,"convertToClick",(e=>{const t=new MouseEvent("click",{bubbles:!0});t.stopPropagation=()=>{},e.target.dispatchEvent(t)})),Ho(this,"preparePopups",(()=>{const{popups:e=[],map:t}=this.props,o=t.getSize();return(this._popups||[]).forEach((e=>{let{popup:o,observer:r}=e;r&&r.disconnect(),o&&t.removeOverlay(o)})),this._popups=e.map((e=>{const r=20,s=Math.round(.9*o[0])-2*r,i=Math.round(.9*o[1])-2*r,{id:n,position:{coordinates:a},className:l,maxWidth:p=s,maxHeight:h=i,autoPan:c=!1,autoPanMargin:u=r,offset:d=[0,0],autoPanAnimation:m={duration:200}}=e,g=p>s?s:p,y=h>i?i:h,f=zo.fH(n,l),v=new He.Z({id:n,element:f,autoPan:c,offset:d,autoPanMargin:u,autoPanAnimation:m,positioning:"bottom-center",className:"ol-overlay-container ol-unselectable",position:a});t.addOverlay(v);const _=function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new MutationObserver((()=>{e.getMap().getSize()&&(e.setPosition(void 0),e.setPosition(o.coordinates))}));return r.observe(t,{attributes:!0,childList:!0,subtree:!0}),r}(v,f,{coordinates:a});return{popup:v,observer:_,containerStyle:{maxWidth:g,maxHeight:y},...e}})),this._popups})),Ho(this,"stopPropagationOnPointerMove",(e=>{e.stopPropagation()}))}UNSAFE_componentWillMount(){this.props.map&&this.props.map.getOverlayContainerStopEvent().addEventListener("pointermove",this.stopPropagationOnPointerMove)}shouldComponentUpdate(e){let{popups:t}=e;return t!==this.props.popups}componentWillUnmount(){this.props.map&&this.props.map.getOverlayContainerStopEvent().removeEventListener("pointermove",this.stopPropagationOnPointerMove)}render(){return S().createElement("div",null,this.renderPopups())}}Ho(Uo,"propTypes",{map:i().object,popups:i().arrayOf(i().object),onPopupClose:i().func}),Ho(Uo,"defaultProps",{popups:[],onPopupClose:()=>{}});var Wo=o(43033);let qo;const Ko={LMap:de,Layer:_e,Feature:Ge,MeasurementSupport:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,l.qC)((0,l.fw)({intl:i().object}),(0,l.WY)((e=>{let{intl:t}=e;return!!t}),r.injectIntl,(0,l.vl)({intl:h})),(0,l.x3)(["intl"],(t=>{let{intl:o={}}=t;return e.reduce((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return{...e,[t]:o[t]}}),{})})),p(["intl"]))}(["formatNumber"])(Ct),Overview:Nt,ScaleBar:Xt,DrawSupport:Mo,HighlightFeatureSupport:jo,SelectionSupport:Do,PopupSupport:Uo,BoxSelectionSupport:e=>{const{map:t,onBoxEnd:o,status:r}=e;return(0,E.useEffect)((()=>{"start"===r?(qo=new Wo.Z({condition:function(e){return e.originalEvent.altKey}}),t.addInteraction(qo)):"end"===r&&t.removeInteraction(qo)}),[r]),(0,E.useEffect)((()=>{qo&&qo.on("boxend",(e=>{o({boxExtent:qo.getGeometry().getExtent(),modifiers:{ctrl:e.mapBrowserEvent.pointerEvent.ctrlKey,metaKey:e.mapBrowserEvent.pointerEvent.metaKey}})}))}),[r]),null}}},14976:(e,t,o)=>{"use strict";o.d(t,{Z:()=>i});var r=o(23645),s=o.n(r)()((function(e){return e[1]}));s.push([e.id,".fgjson-app .ol-control button:hover, .fgjson-app .ol-control button:focus {\r\n    background-color: #f4f4f4;\r\n}\r\n.fgjson-app .ol-zoom .ol-zoom-out, .fgjson-app .ol-zoom .ol-zoom-in{\r\n    width: 26px;\r\n    height: 26px;\r\n    line-height: 26px;\r\n    display: block;\r\n\r\n    color: black;\r\n    background-color: #fff;\r\n    border-width: 0;\r\n    margin:0;\r\n}\r\n.fgjson-app .ol-zoom.ol-unselectable.ol-control .ol-zoom-in, .fgjson-app .ol-zoom.ol-unselectable.ol-control .ol-zoom-out {\r\n    font-family: 'Lucida Console', Monaco, monospace;\r\n    text-align: center;\r\n    text-decoration: none;\r\n    font-weight: bold;\r\n}\r\n\r\n.fgjson-app .ol-zoom .ol-zoom-out{\r\n    font-size: 18px;\r\n    border-radius: 0 0 4px 4px;\r\n}\r\n.fgjson-app .ol-zoom .ol-zoom-in{\r\n    border-bottom: 1px solid #ccc;\r\n    border-radius: 4px 4px 0 0;\r\n    font-size: 20px;\r\n}\r\n.fgjson-app .ol-zoom.ol-unselectable.ol-control{\r\n    top:10px;\r\n    left:10px;\r\n    padding:0;\r\n    box-shadow: rgba(0, 0, 0, 0.65098) 0px 1px 5px 0px;\r\n    border-radius: 4px;\r\n}\r\n\r\n.fgjson-app .ol-scale-line.ol-unselectable{\r\n    background-color: rgba(255, 255, 255, 0.8);\r\n}\r\n",""]);const i=s},57641:(e,t,o)=>{"use strict";o.d(t,{Z:()=>i});var r=o(23645),s=o.n(r)()((function(e){return e[1]}));s.push([e.id,".fgjson-app .ol-custom-overviewmap,\r\n       .fgjson-app .ol-custom-overviewmap.ol-uncollapsible {\r\n          bottom: 20px;\r\n          left: auto;\r\n          right: 10px;\r\n          top: auto;\r\n\r\n      }\r\n      .fgjson-app .ol-custom-overviewmap:not(.ol-collapsed)  {\r\n\r\n           box-shadow: 0 1px 5px rgba(0,0,0,0.65);\r\n           border-radius: 1px;\r\n           transition: all .2s;\r\n      }\r\n      .fgjson-app .ol-custom-overviewmap .ol-overviewmap-map {\r\n          border: none;\r\n          width: 300px;\r\n          height: 150px;\r\n\r\n      }\r\n\r\n      .fgjson-app .ol-custom-overviewmap .ol-overviewmap-box {\r\n          border: 1px solid black;\r\n          cursor: pointer;\r\n          border-radius: 5px;\r\n      }\r\n\r\n      .fgjson-app .ol-custom-overviewmap:not(.ol-collapsed) button{\r\n          bottom: auto;\r\n          left: auto;\r\n          right: 2px;\r\n          bottom: 2px;\r\n      }\r\n\r\n      .fgjson-app .ol-rotate {\r\n          top: 170px;\r\n          right: 0;\r\n      }\r\n      .fgjson-app .ol-overview-dargbox{\r\n           border: 1px solid black;\r\n           background-color: rgba(125,125,0,.5);\r\n           border-radius: 5px;\r\n      }\r\n",""]);const i=s},91133:(e,t,o)=>{"use strict";o.d(t,{Z:()=>i});var r=o(23645),s=o.n(r)()((function(e){return e[1]}));s.push([e.id,'.fgjson-app .ol-box {\n  box-sizing: border-box;\n  border-radius: 2px;\n  border: 2px solid blue;\n}\n\n.fgjson-app .ol-mouse-position {\n  top: 8px;\n  right: 8px;\n  position: absolute;\n}\n\n.fgjson-app .ol-scale-line {\n  background: rgba(0,60,136,0.3);\n  border-radius: 4px;\n  bottom: 8px;\n  left: 8px;\n  padding: 2px;\n  position: absolute;\n}\n.fgjson-app .ol-scale-line-inner {\n  border: 1px solid #eee;\n  border-top: none;\n  color: #eee;\n  font-size: 10px;\n  text-align: center;\n  margin: 1px;\n  will-change: contents, width;\n}\n.fgjson-app .ol-overlay-container {\n  will-change: left,right,top,bottom;\n}\n\n.fgjson-app .ol-unsupported {\n  display: none;\n}\n.fgjson-app .ol-viewport, .fgjson-app .ol-unselectable {\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: rgba(0,0,0,0);\n}\n.fgjson-app .ol-selectable {\n  -webkit-touch-callout: default;\n  -webkit-user-select: text;\n  -moz-user-select: text;\n  -ms-user-select: text;\n  user-select: text;\n}\n.fgjson-app .ol-grabbing {\n  cursor: -webkit-grabbing;\n  cursor: -moz-grabbing;\n  cursor: grabbing;\n}\n.fgjson-app .ol-grab {\n  cursor: move;\n  cursor: -webkit-grab;\n  cursor: -moz-grab;\n  cursor: grab;\n}\n.fgjson-app .ol-control {\n  position: absolute;\n  background-color: rgba(255,255,255,0.4);\n  border-radius: 4px;\n  padding: 2px;\n}\n.fgjson-app .ol-control:hover {\n  background-color: rgba(255,255,255,0.6);\n}\n.fgjson-app .ol-zoom {\n  top: .5em;\n  left: .5em;\n}\n.fgjson-app .ol-rotate {\n  top: .5em;\n  right: .5em;\n  transition: opacity .25s linear, visibility 0s linear;\n}\n.fgjson-app .ol-rotate.ol-hidden {\n  opacity: 0;\n  visibility: hidden;\n  transition: opacity .25s linear, visibility 0s linear .25s;\n}\n.fgjson-app .ol-zoom-extent {\n  top: 4.643em;\n  left: .5em;\n}\n.fgjson-app .ol-full-screen {\n  right: .5em;\n  top: .5em;\n}\n@media print {\n  .fgjson-app .ol-control {\n    display: none;\n  }\n}\n\n.fgjson-app .ol-control button {\n  display: block;\n  margin: 1px;\n  padding: 0;\n  color: white;\n  font-size: 1.14em;\n  font-weight: bold;\n  text-decoration: none;\n  text-align: center;\n  height: 1.375em;\n  width: 1.375em;\n  line-height: .4em;\n  background-color: rgba(0,60,136,0.5);\n  border: none;\n  border-radius: 2px;\n}\n.fgjson-app .ol-control button::-moz-focus-inner {\n  border: none;\n  padding: 0;\n}\n.fgjson-app .ol-zoom-extent button {\n  line-height: 1.4em;\n}\n.fgjson-app .ol-compass {\n  display: block;\n  font-weight: normal;\n  font-size: 1.2em;\n  will-change: transform;\n}\n.fgjson-app .ol-touch .ol-control button {\n  font-size: 1.5em;\n}\n.fgjson-app .ol-touch .ol-zoom-extent {\n  top: 5.5em;\n}\n.fgjson-app .ol-control button:hover,\n.fgjson-app .ol-control button:focus {\n  text-decoration: none;\n  background-color: rgba(0,60,136,0.7);\n}\n.fgjson-app .ol-zoom .ol-zoom-in {\n  border-radius: 2px 2px 0 0;\n}\n.fgjson-app .ol-zoom .ol-zoom-out {\n  border-radius: 0 0 2px 2px;\n}\n\n\n.fgjson-app .ol-attribution {\n  text-align: right;\n  bottom: .5em;\n  right: .5em;\n  max-width: calc(100% - 1.3em);\n}\n\n.fgjson-app .ol-attribution ul {\n  margin: 0;\n  padding: 0 .5em;\n  font-size: .7rem;\n  line-height: 1.375em;\n  color: #000;\n  text-shadow: 0 0 2px #fff;\n}\n.fgjson-app .ol-attribution li {\n  display: inline;\n  list-style: none;\n  line-height: inherit;\n}\n.fgjson-app .ol-attribution li:not(:last-child):after {\n  content: " ";\n}\n.fgjson-app .ol-attribution img {\n  max-height: 2em;\n  max-width: inherit;\n  vertical-align: middle;\n}\n.fgjson-app .ol-attribution ul, .fgjson-app .ol-attribution button {\n  display: inline-block;\n}\n.fgjson-app .ol-attribution.ol-collapsed ul {\n  display: none;\n}\n.fgjson-app .ol-attribution:not(.ol-collapsed) {\n  background: rgba(255,255,255,0.8);\n}\n.fgjson-app .ol-attribution.ol-uncollapsible {\n  bottom: 0;\n  right: 0;\n  border-radius: 4px 0 0;\n  height: 1.1em;\n  line-height: 1em;\n}\n.fgjson-app .ol-attribution.ol-uncollapsible img {\n  margin-top: -.2em;\n  max-height: 1.6em;\n}\n.fgjson-app .ol-attribution.ol-uncollapsible button {\n  display: none;\n}\n\n.fgjson-app .ol-zoomslider {\n  top: 4.5em;\n  left: .5em;\n  height: 200px;\n}\n.fgjson-app .ol-zoomslider button {\n  position: relative;\n  height: 10px;\n}\n\n.fgjson-app .ol-touch .ol-zoomslider {\n  top: 5.5em;\n}\n\n.fgjson-app .ol-overviewmap {\n  left: 0.5em;\n  bottom: 0.5em;\n}\n.fgjson-app .ol-overviewmap.ol-uncollapsible {\n  bottom: 0;\n  left: 0;\n  border-radius: 0 4px 0 0;\n}\n.fgjson-app .ol-overviewmap .ol-overviewmap-map,\n.fgjson-app .ol-overviewmap button {\n  display: inline-block;\n}\n.fgjson-app .ol-overviewmap .ol-overviewmap-map {\n  border: 1px solid #7b98bc;\n  height: 150px;\n  margin: 2px;\n  width: 150px;\n}\n.fgjson-app .ol-overviewmap:not(.ol-collapsed) button{\n  bottom: 1px;\n  left: 2px;\n  position: absolute;\n}\n.fgjson-app .ol-overviewmap.ol-collapsed .ol-overviewmap-map,\n.fgjson-app .ol-overviewmap.ol-uncollapsible button {\n  display: none;\n}\n.fgjson-app .ol-overviewmap:not(.ol-collapsed) {\n  background: rgba(255,255,255,0.8);\n}\n.fgjson-app .ol-overviewmap-box {\n  border: 2px dotted rgba(0,60,136,0.7);\n}\n\n.fgjson-app .ol-overviewmap .ol-overviewmap-box:hover {\n  cursor: move;\n}\n',""]);const i=s},80760:(e,t,o)=>{var r=o(89881);e.exports=function(e,t){var o=[];return r(e,(function(e,r,s){t(e,r,s)&&o.push(e)})),o}},89179:(e,t,o)=>{var r=o(55639),s=o(40554),i=o(14841),n=o(79833),a=r.isFinite,l=Math.min;e.exports=function(e){var t=Math[e];return function(e,o){if(e=i(e),(o=null==o?0:l(s(o),292))&&a(e)){var r=(n(e)+"e").split("e"),p=t(r[0]+"e"+(+r[1]+o));return+((r=(n(p)+"e").split("e"))[0]+"e"+(+r[1]-o))}return t(e)}}},57043:(e,t,o)=>{var r=o(62488),s=o(21078),i=o(278),n=o(1469);e.exports=function(){var e=arguments.length;if(!e)return[];for(var t=Array(e-1),o=arguments[0],a=e;a--;)t[a-1]=arguments[a];return r(n(o)?i(o):[o],s(t,1))}},43624:(e,t,o)=>{var r=o(14259),s=o(40554);e.exports=function(e,t,o){var i=null==e?0:e.length;return i?(t=o||void 0===t?1:s(t),r(e,0,(t=i-t)<0?0:t)):[]}},63105:(e,t,o)=>{var r=o(34963),s=o(80760),i=o(67206),n=o(1469);e.exports=function(e,t){return(n(e)?r:s)(e,i(t,3))}},97398:(e,t,o)=>{var r=o(55639).isFinite;e.exports=function(e){return"number"==typeof e&&r(e)}},59854:(e,t,o)=>{var r=o(89179)("round");e.exports=r},55691:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>n});var r=o(93379),s=o.n(r),i=o(57641);s()(i.Z,{insert:"head",singleton:!1});const n=i.Z.locals||{}}}]);